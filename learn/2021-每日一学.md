#### 2021å¹´01æœˆ08æ—¥ å‘¨äº” ç¬¬02å‘¨

(1)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šé˜Ÿåˆ—ä»»åŠ¡-ä»£ç æ“ä½œ

#### 2021å¹´01æœˆ11æ—¥ å‘¨ä¸€ ç¬¬03å‘¨

(1) React æºç æ·±åº¦è§£æï¼š memo ç»„ä»¶çš„æ›´æ–° & completeUnitWorkçš„æ•´ä½“æµç¨‹å’Œæ„ä¹‰ã€‚

- æ ¹æ®æ˜¯å¦ä¸­æ–­è°ƒç”¨ä¸åŒçš„æ–¹æ³•ï¼›
- åˆ¤æ–­æ˜¯å¦æœ‰å…„å¼ŸèŠ‚ç‚¹æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œï¼›
- å®ŒæˆèŠ‚ç‚¹ä¹‹åèµ‹å€¼ effect é“¾ï¼›

(2)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šä»»åŠ¡é˜Ÿåˆ—ä»£ç å®æ“

```js
export default (tasks, n) => {
    // å£°æ˜ä¸€ä¸ªå˜é‡è®°å½•æœ€ç»ˆä»»åŠ¡çš„é¡ºåº
    let q = ''
    // ä»»åŠ¡åˆ†ç±»
    let Q = {}
    tasks.forEach(item => {
        if (Q[item]) {
            Q[item]++
        } else {
            Q[item]=1 
        }
    });
    while (1) {
        let keys = Object.keys(Q)
        if (!keys[0]) {
           break
        } 
        // n+1 ä¸ºä¸€ç»„
        let tmp = []
        for (let i = 0; i <= n; i++) {
            let max = 0
            let key
            let pos
            // ä»æ‰€æœ‰çš„ä»»åŠ¡ä¸­æ‰¾åˆ°æœªå¤„ç†æ•°æœ€å¤§çš„ä¼˜å…ˆå®‰æ’
            keys.forEach((item, idx) => {
                if (Q[item] > max) {
                    max = Q[item]
                    key = item
                    pos = idx
                }
            })
            if (key) {
                tmp.push(key)
                keys.splice(pos, 1)
                Q[key]--
                if (Q[key] < 1) {
                    delete Q[key]
                }
            } else {
                break
            }
        }
        q+=tmp.join('').padEnd(n+1,'-')
    }
    // A--A--A-- æ›¿æ¢ä¸º A--A--A
    q=q.replace(/-+$/g,'')
    return q.length
}
```

(3) æ•°æ®ç»“æ„ï¼šæ’åºé“¾è¡¨ & ç¯å½¢é“¾è¡¨ï¼Œé‡ç‚¹æ˜¯ï¼šå¦‚ä½•æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼›çŸ¥é“é“¾è¡¨å¦‚ä½•æ’åºï¼›å¦‚ä½•æ£€æµ‹é“¾è¡¨æ˜¯é—­ç¯çš„ã€‚

æ’åºé“¾è¡¨ï¼šåœ¨O(n log n) æ—¶é—´å¤æ‚åº¦å’Œå¸¸æ•°çº§ç©ºé—´å¤æ‚åº¦ä¸‹ï¼Œå¯¹é“¾è¡¨è¿›è¡Œæ’åºã€‚

ç¤ºä¾‹1ï¼š

```html
è¾“å…¥: 4->2->1->3
è¾“å‡º: 1->2->3->4
```

ç¤ºä¾‹2ï¼š

```html
è¾“å…¥: -1->5->3->4->0
è¾“å‡º: -1->0->3->4->5
```

å¿«é€Ÿæ’åºçš„æœ¬è´¨ï¼šåœ¨éå†æ—¶é€‰æ‹©ä¸€ä¸ªåŸºå‡†å…ƒç´ ï¼Œæ’åºä¸­çš„ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥ä½œä¸ºåŸºå‡†å…ƒç´ ï¼Œé€šå¸¸æƒ…å†µä¸‹é€‰ç¬¬ä¸€ä¸ªå°±å¯ä»¥ã€‚æŠŠæ‰€æœ‰å°äºåŸºå‡†å…ƒç´ çš„å…ƒç´ ï¼Œæ”¾åœ¨åŸºå‡†å…ƒç´ çš„å·¦è¾¹ï¼›å¤§äºåŸºå‡†å…ƒç´ çš„å…ƒç´ ï¼Œæ”¾åœ¨åŸºå‡†å…ƒç´ çš„å³è¾¹ï¼›ç„¶åé€’å½’å·¦è¾¹å’Œå³è¾¹çš„æ‰€æœ‰å…ƒç´ ã€‚

é“¾è¡¨åªä¼šæš´éœ²ä¸€ä¸ªå¤´æŒ‡é’ˆï¼Œæ‰€æœ‰çš„å…ƒç´ æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®åˆ°çš„ï¼Œå¿…é¡»é€šè¿‡å¤´æŒ‡é’ˆä¸æ–­åœ°è®¿é—® next å¯¹è±¡ï¼Œæ‰èƒ½æ‹¿åˆ°å…·ä½“çš„å…ƒç´ ã€‚è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆp,qï¼Œéƒ½æ˜¯æŒ‡å‘å¤´å…ƒç´ ï¼Œp æŒ‡é’ˆå·¦ä¾§çš„å…ƒç´ æ˜¯å°äºåŸºå‡†å…ƒç´ çš„ï¼Œp ä¸ q ä¹‹é—´çš„å…ƒç´ æ˜¯å¤§äºåŸºå‡†å…ƒç´ çš„ã€‚

#### 2021å¹´01æœˆ12æ—¥ å‘¨äºŒ ç¬¬03å‘¨

(1) é«˜ä»¿ç»„ä»¶åº“:

> å‚è€ƒç½‘ç«™ï¼šhttp://vikingship.xyz

- vikingship æ˜¯æ•™å­¦ç»„ä»¶åº“ï¼Œä½¿ç”¨ React Hooks å’Œ typescript ï¼›
- learning-typescript ä¸ºç¬¬äºŒç«  Typescript å…¥é—¨æºä»£ç ï¼Œåªé’ˆå¯¹ç¬¬äºŒç« ï¼›
- react-with-ts ä¸ºè¯¾ç¨‹ç¬¬ä¸‰ç« ï¼Œç¥å¥‡çš„ React æºä»£ç ï¼›

#### 2021å¹´01æœˆ13æ—¥ å‘¨ä¸‰ ç¬¬03å‘¨

(1)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šé“¾è¡¨çš„å¿«é€Ÿæ’åºæ¯”å †æ’åºä½¿ç”¨çš„åœºæ™¯æ›´å¤šã€‚

(2)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šç¯å½¢é“¾è¡¨-åŸç†è®²è§£

ç¯å½¢é“¾è¡¨ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰å¾ªç¯ã€‚ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° `pos` æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚å¦‚æœ `pos` æ˜¯ `-1` ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼šhead = [3,2,0,-4],pos = 1
è¾“å‡ºï¼štrue
è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚
```

(3) ç¯å½¢é“¾è¡¨-ä»£ç å®æ“

#### 2021å¹´01æœˆ14æ—¥ å‘¨å›› ç¬¬03å‘¨

(1) æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šèºæ—‹çŸ©é˜µ & æ—‹è½¬å›¾åƒ

ç»™å®šä¸€ä¸ªåŒ…å« m x n ä¸ªå…ƒç´ çš„çŸ©é˜µï¼ˆmè¡Œï¼Œnåˆ—ï¼‰ï¼Œè¯·æŒ‰ç…§é¡ºæ—¶é’ˆèºæ—‹é¡ºåºï¼Œè¿”å›çŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼š
[
	[1,2,3],
	[4,5,6],
	[7,8,9]
]
è¾“å‡ºï¼š[1,2,3,6,9,8,7,4,5]
```

(2) æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šæ—‹è½¬å›¾åƒ

ç»™å®šä¸€ä¸ª n x n çš„äºŒç»´çŸ©é˜µè¡¨ç¤ºä¸€ä¸ªå›¾åƒã€‚å°†å›¾åƒé¡ºæ—¶é’ˆæ—‹è½¬ 90 åº¦ã€‚è¯´æ˜ï¼šä½ å¿…é¡»åœ¨åŸåœ°æ—‹è½¬å›¾åƒï¼Œè¿™æ„å‘³ç€ä½ éœ€è¦ç›´æ¥ä¿®æ”¹è¾“å…¥çš„äºŒç»´çŸ©é˜µã€‚è¯·ä¸è¦ä½¿ç”¨å¦ä¸€ä¸ªçŸ©é˜µæ¥æ—‹è½¬å›¾åƒã€‚

ç¤ºä¾‹1ï¼š

```
ç»™å®š matrix = 
[
	[1,2,3],
	[4,5,6],
	[7,8,9]
]
åŸåœ°æ—‹è½¬è¾“å…¥çŸ©é˜µï¼Œä½¿å…¶å˜ä¸ºï¼š
[
	[7,4,1],
	[8,5,2],
	[9,6,3]
]
```

ç¤ºä¾‹2ï¼š

```
ç»™å®š matrix = 
[
 [5,1,9,11],
 [2,4,8,10],
 [13,3,6,7],
 [15,14,12,16]
]
åŸåœ°æ—‹è½¬è¾“å…¥çŸ©é˜µï¼Œä½¿å…¶å˜ä¸ºï¼š
[
	[15,13,2,5],
	[14,3,4,1],
	[12,6,8,9],
	[16,7,10,11]
]
```

#### 2021å¹´01æœˆ15æ—¥ å‘¨äº” ç¬¬03å‘¨

(1)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šæ—‹è½¬å›¾åƒ-ä»£ç å®æ“

```js
export default (arr) => {
  // è·å– n çš„ç»´åº¦
  let vecor = arr.length;
  // å‚ç›´ç¿»è½¬
  for (let i = 0, len = vecor / 2; i < len; i++) {
    for (let j = 0, tmp; j < vecor; j++) {
      tmp = arr[i][j];
      arr[i][j] = arr[vecor - i - 1][j];
      arr[vecor - i - 1][j] = tmp;
    }
  }
  // å¯¹è§’çº¿ç¿»è½¬
  for (let i = 0; i < vecor; i++) {
    for (let j = 0, tmp; j < i; j++) {
      let tmp = arr[i][j];
      arr[i][j] = arr[j][i];
      arr[j][i] = tmp;
    }
  }
  return arr;
};
```

(2)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šå¯¹ç§°äºŒå‰æ ‘-åŸç†è®²è§£ï¼ŒäºŒå‰æ ‘æ˜¯å‡ºç°é¢‘ç‡å¾ˆé«˜ï¼Œéš¾åº¦æœ€å¤§çš„æ•°æ®ç»“æ„ã€‚äºŒå‰æ ‘çš„ç‰¹æ€§ä¹‹ä¸€æ˜¯ä¸€ä¸ªèŠ‚ç‚¹åªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œå·¦èŠ‚ç‚¹å’Œå³èŠ‚ç‚¹ã€‚

ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦æ˜¯é•œåƒå¯¹ç§°ã€‚ä¾‹å¦‚ï¼ŒäºŒå‰æ ‘ `[1,2,2,3,4,4,3] ` æ˜¯å¯¹ç§°çš„ã€‚

```
	    1
	  /	 \
   2 		2
 /  \   / \
3   4  4   3
```

ä½†æ˜¯ä¸‹é¢è¿™ä¸ª `[1,2,2,null,3,null,3] ` åˆ™ä¸æ˜¯é•œåƒå¯¹ç§°çš„ï¼š

```
		1
	/		\
	2		2
	\ 	\
	3 	3
```

(3) æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šå¯¹ç§°äºŒå‰æ ‘-ä»£ç å®æ“

```js
// æ„é€ äºŒå‰æ ‘æ•°æ®ç»“æ„
// äºŒå‰æ ‘çš„èŠ‚ç‚¹
class Node {
  constructor(val) {
    this.val = val;
    this.left = this.right = undefined;
  }
}
// å£°æ˜ä¸€ä¸ªäºŒå‰æ ‘
class Tree {
  constructor(data) {
    // ä¸´æ—¶å­˜å‚¨æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ–¹ä¾¿å¯»æ‰¾çˆ¶å­èŠ‚ç‚¹
    let nodeList = [];
    // é¡¶èŠ‚ç‚¹
    let root;
    for (let i = 0, len = data.length; i < len; i++) {
      let node = new Node(data[i]);
      nodeList.push(node);
      if (i > 0) {
        // è®¡ç®—å½“å‰èŠ‚ç‚¹å±äºå“ªä¸€å±‚
        let n = Math.floor(Math.sqrt(i + 1));
        // è®°å½•å½“å‰å±‚çš„èµ·å§‹ç‚¹
        let q = Math.pow(2, n) - 1;
        // è®°å½•ä¸Šä¸€å±‚çš„èµ·å§‹ç‚¹
        let p = Math.pow(2, n - 1) - 1;
        // æ‰¾åˆ°å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
        let parent = nodeList[p + Math.floor((i - q) / 2)];
        // å°†å½“å‰èŠ‚ç‚¹å’Œä¸Šä¸€å±‚çš„çˆ¶èŠ‚ç‚¹åšå…³è”
        if (parent.left) {
          parent.right = node;
        } else {
          parent.left = node;
        }
      }
    }
    root = nodeList.shift();
    nodeList.length = 0;
    return root;
  }
  // åˆ¤æ–­æ˜¯å¦å¯¹ç§°çš„é™æ€æ–¹æ³•
  static isSymmetry(root) {
    if (!root) {
      return true;
    }
    let walk = (left, right) => {
      if (!left && !right) {
        return true;
      }
      if ((left && !right) || (!left && right) || left.val !== right.val) {
        return false;
      }
      return walk(left.left, right.right) && walk(left.right, right.left);
    };
    return walk(root.left, root.right);
  }
}

export default Tree;
export { Node };
```

#### 2021å¹´01æœˆ16æ—¥ å‘¨å…­ ç¬¬03å‘¨

(1)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šéªŒè¯äºŒå‰æœç´¢æ ‘

ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„äºŒå‰æœç´¢æ ‘ã€‚å‡è®¾ä¸€ä¸ªäºŒå‰æœç´¢æ ‘å…·æœ‰å¦‚ä¸‹ç‰¹å¾ï¼š

- èŠ‚ç‚¹çš„å·¦å­æ ‘åªåŒ…å«å°äºå½“å‰èŠ‚ç‚¹çš„æ•°ã€‚
- èŠ‚ç‚¹çš„å³å­æ ‘åªåŒ…å«å¤§äºå½“å‰èŠ‚ç‚¹çš„æ•°ã€‚
- æ‰€æœ‰å·¦å­æ ‘å’Œå³å­æ ‘è‡ªèº«å¿…é¡»ä¹Ÿæ˜¯äºŒå‰æœç´¢æ ‘ã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼š
 		2
 	/  \
 	1 	3
è¾“å‡ºï¼štrue
```

(2)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šéªŒè¯äºŒå‰æœç´¢æ ‘-ä»£ç å®æ“

```js
class Node {
  constructor(val) {
    this.val = val;
    this.left = this.right = undefined;
  }
}

class Tree {
  constructor(data) {
    let root = new Node(data.shift());
    //   éå†æ‰€æœ‰çš„æ•°æ®ï¼Œé€æ¸æ’å…¥åˆ°å½“å‰è¿™æ£µæœç´¢æ ‘ä¸Š
    data.forEach((item) => {
      this.insert(root, item);
    });
    return root;
  }
  insert(node, data) {
    if (node.val > data) {
      if (node.left === undefined) {
        node.left = new Node(data);
      } else {
        this.insert(node.left, data);
      }
    } else {
      if (node.right === undefined) {
        node.right = new Node(data);
      } else {
        this.insert(node.right, data);
      }
    }
  }
  static walk(root) {
    if (!root.left && !root.right) {
      return true;
    } else if (
      (root.left && root.val < root.left.val) ||
      (root.right && root.val > root.right.val)
    ) {
      return false;
    } else {
      return Tree.walk(root.left) && Tree.walk(root.right);
    }
  }
}

export default Tree;
export { Node };
```

(3)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šå †æ’åº-åŸç†è®²è§£ï¼Œæ ¹æ®å­—ç¬¦ä¸²å‡ºç°é¢‘ç‡æ’åºï¼ˆæ’åºï¼‰ & è¶…çº§ä¸‘æ•°ï¼ˆæŸ¥æ‰¾ï¼‰

å †æ›´é è¿‘äºŒå‰æ ‘ï¼Œè€Œéå †æ ˆï¼›åº”ç”¨åœºæ™¯ï¼šåˆ©ç”¨å †çš„æ•°æ®ç»“æ„å»æ’åºå’ŒæŸ¥æ‰¾ã€‚

åŸºæœ¬æ¦‚å¿µï¼š

- å †å¿…é¡»æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼ˆn-1å±‚æ˜¯æ»¡äºŒå‰æ ‘ï¼Œéƒ½æœ‰å·¦å³èŠ‚ç‚¹ï¼‰ï¼›

- ä»»ä¸€èŠ‚ç‚¹çš„å€¼æ˜¯å…¶å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼ã€‚

ä¾‹å¦‚ï¼š

```
		  	56(æœ€å¤§å †)
			 /   \
		 19     40
    / \     /
   18  9   3
```


```
		  	 5(æœ€å°å †)
			 /   \
		 16     30
    / \     /
   49  18  38
```

#### 2021å¹´01æœˆ17æ—¥ å‘¨æ—¥ ç¬¬03å‘¨

do nothing.

#### 2021å¹´01æœˆ18æ—¥ å‘¨ä¸€ ç¬¬04å‘¨

(1)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šå †æ’åº-ä»£ç æ¼”ç¤º

```js
class Heap {
  constructor(data) {
    this.data = data;
  }
  sort() {
    let iArr = this.data;
    let n = iArr.length;
    if (n <= 1) {
      return iArr;
    } else {
      for (let i = Math.floor(n / 2); i >= 0; i--) {
        Heap.maxHeapify(iArr, i, n);
      }
      for (let j = 0; j < n; j++) {
        Heap.swap(iArr, 0, n - 1 - j);
        Heap.maxHeapify(iArr, 0, n - 1 - j - 1);
      }
      return iArr;
    }
  }
  // äº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„æ–¹æ³•
  static swap(arr, a, b) {
    if (a === b) {
      return "";
    }
    let c = arr[a];
    arr[a] = arr[b];
    arr[b] = c;
  }
  /**
   * æ„å»ºæœ€å¤§å †çš„è¿‡ç¨‹
   * @param {*} Arr æ•°ç»„
   * @param {*} i  å“ªä¸ªèŠ‚ç‚¹
   * @param {*} size æ•°ç»„æœ‰æ•ˆé•¿åº¦
   */
  static maxHeapify(Arr, i, size) {
    // å·¦èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼‰
    let l = i * 2 + 1;
    // å³èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼‰
    let r = i * 2 + 2;
    let largest = i;
    // çˆ¶èŠ‚ç‚¹iå’Œå·¦èŠ‚ç‚¹lä½œæ¯”è¾ƒå–æœ€å¤§å€¼
    if (l <= size && Arr[l] > Arr[largest]) {
      largest = l;
    }
    // å³èŠ‚ç‚¹å’Œæœ€å¤§å€¼æ¯”è¾ƒ
    if (r <= size && Arr[r] > Arr[largest]) {
      largest = r;
    }
    if (largest !== i) {
      Heap.swap(Arr, i, largest);
      Heap.maxHeapify(Arr, largest, size);
    }
  }
}

export default Heap;
```

(2)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šå †æ’åº-ä»£ç æ¼”ç¤º

æ ¹æ®å­—ç¬¦å‡ºç°é¢‘ç‡æ’åºï¼Œç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯·å°†å­—ç¬¦ä¸²é‡Œçš„å­—ç¬¦æŒ‰ç…§å‡ºç°çš„é¢‘ç‡é™åºæ’åˆ—ã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼š"tree"
è¾“å‡ºï¼š"eert"
è§£é‡Šï¼š'e' å‡ºç°ä¸¤æ¬¡ï¼Œ'r'å’Œ't'éƒ½åªå‡ºç°ä¸€æ¬¡ã€‚å› æ­¤'e'å¿…é¡»å‡ºç°åœ¨'r'å’Œ't'ä¹‹å‰ã€‚æ­¤å¤–ï¼Œ"eetr"ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç­”æ¡ˆã€‚
```

ç¬¬ä¸€æ­¥ï¼šç»Ÿè®¡ï¼›ç¬¬äºŒæ­¥ï¼šæ’åºï¼›ç¬¬ä¸‰æ­¥ï¼šè¾“å‡ºï¼›

```js
class Heap {
  constructor(str) {
    let map = new Map();
    str.split("").forEach((item) => {
      if (map.has(item)) {
        map.set(item, map.get(item) + 1);
      } else {
        map.set(item, 1);
      }
    });
    this.map = map;
    this.data = Array.from(map.values());
  }
  sort() {
    let iArr = this.data;
    let n = iArr.length;
    if (n <= 1) {
      return iArr;
    } else {
      for (let i = Math.floor(n / 2); i >= 0; i--) {
        Heap.maxHeapify(iArr, i, n);
      }
      for (let j = 0; j < n; j++) {
        Heap.swap(iArr, 0, n - 1 - j);
        Heap.maxHeapify(iArr, 0, n - 1 - j - 1);
      }
      return iArr;
    }
  }
  toString() {
    let arr = this.sort();
    let str = [];
    while (arr.length) {
      let top = arr.pop();
      for (let [k, v] of this.map) {
        if (v === top) {
          str.push(k.repeat(v));
          this.map.delete(k);
          break;
        }
      }
    }
    return str.join("");
  }
  // äº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„æ–¹æ³•
  static swap(arr, a, b) {
    if (a === b) {
      return "";
    }
    let c = arr[a];
    arr[a] = arr[b];
    arr[b] = c;
  }
  /**
   * æ„å»ºæœ€å¤§å †çš„è¿‡ç¨‹
   * @param {*} Arr æ•°ç»„
   * @param {*} i  å“ªä¸ªèŠ‚ç‚¹
   * @param {*} size æ•°ç»„æœ‰æ•ˆé•¿åº¦
   */
  static maxHeapify(Arr, i, size) {
    // å·¦èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼‰
    let l = i * 2 + 1;
    // å³èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼‰
    let r = i * 2 + 2;
    let largest = i;
    // çˆ¶èŠ‚ç‚¹iå’Œå·¦èŠ‚ç‚¹lä½œæ¯”è¾ƒå–æœ€å¤§å€¼
    if (l <= size && Arr[l] > Arr[largest]) {
      largest = l;
    }
    // å³èŠ‚ç‚¹å’Œæœ€å¤§å€¼æ¯”è¾ƒ
    if (r <= size && Arr[r] > Arr[largest]) {
      largest = r;
    }
    if (largest !== i) {
      Heap.swap(Arr, i, largest);
      Heap.maxHeapify(Arr, largest, size);
    }
  }
}

export default Heap;
```

(3)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šè¶…çº§ä¸‘æ•°ï¼Œä¸‘æ•°ï¼Œè´¨å› æ•°ï¼Œè´¨æ•°ã€‚

ç¼–å†™ä¸€æ®µç¨‹åºæ¥æŸ¥æ‰¾ç¬¬ n ä¸ªè¶…çº§ä¸‘æ•°ã€‚è¶…çº§ä¸‘æ•°æ˜¯æŒ‡å…¶æ‰€æœ‰è´¨å› æ•°éƒ½æ˜¯é•¿åº¦ä¸º k çš„è´¨æ•°åˆ—è¡¨ `primes` ä¸­çš„æ­£æ•´æ•°ã€‚

ç¤ºä¾‹ï¼š

```
è¾“å…¥ï¼šn=12,primes=[2,7,13,19]
è¾“å‡ºï¼š32
è§£é‡Šï¼šç»™å®šé•¿åº¦ä¸º 4 çš„è´¨æ•°åˆ—è¡¨ primes=[2,7,13,19],å‰12ä¸ªè¶…çº§ä¸‘æ•°åˆ—è¡¨ä¸ºï¼š[1,2,4,7,8,13,14,16,19,26,28,32]ã€‚
```

è§£é¢˜æ€è·¯ï¼š

- æ±‚è§£ä»»æ„æ•´æ•°çš„è´¨å› æ•°
- è´¨å› æ•°æ˜¯å¦åœ¨æŒ‡å®šè´¨å› æ•°èŒƒå›´å†…
- æ˜¯å¦è¾¾åˆ°æŒ‡å®šä¸ªæ•° n

#### 2021å¹´01æœˆ20æ—¥ å‘¨ä¸‰ ç¬¬04å‘¨

(1) æ•°æ®ç»“æ„ä¸ç®—æ³•: è¶…çº§ä¸‘æ•°-ä»£ç æ¼”ç¤º(æ•°ç»„æŸ¥æ‰¾)

```js
class Ugly {
  constructor(n, primes) {
    this.n = n;
    this.primes = primes;
  }
  // è®¡ç®—è¶…çº§ä¸‘æ•°
  getAll() {
    // è¶…çº§ä¸‘æ•°åˆ—è¡¨
    let res = [1];
    let i = 2;
    let primes = this.primes;
    while (res.length < this.n) {
      let arr = Ugly.getPrimes(i);
      let k = 0;
      let l = arr.length;
      for (; k < l; k++) {
        if (!primes.find((item) => item === arr[k])) {
          break;
        }
      }
      // k === l æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§å°±æ˜¯å½“å‰è¿™ä¸ªæ•°å‹æ ¹æ²¡æœ‰è´¨å› æ•°ï¼›ä¸€ç§æ˜¯æ‰€æœ‰è´¨å› æ•°éƒ½åœ¨æŒ‡å®šåˆ—è¡¨ä¸­
      if (k === l) {
        if (l === 0) {
          if (primes.find((item) => item === i)) {
            res.push(i);
          }
        } else {
          res.push(i);
        }
      }
      i++;
    }
    return res[this.n - 1];
  }
  // è®¡ç®—æŒ‡å®šæ­£æ•´æ•°nçš„è´¨å› æ•°
  static getPrimes(n) {
    //
    let prime = (n) => {
      // å­˜å‚¨æ‰€æœ‰çš„è´¨å› æ•°
      let arr = [];
      for (let i = 2; i < n / 2 + 1; i++) {
        if (n % i === 0 && !prime(i).length) {
          arr.push(i);
        }
      }
      return arr;
    };
    return prime(n);
  }
}

export default Ugly;
```

(2) æ•°æ®ç»“æ„ä¸ç®—æ³•: è¶…çº§ä¸‘æ•°-ä»£ç æ¼”ç¤º(å †æŸ¥æ‰¾)

```js
class Ugly {
  constructor(n, primes) {
    this.n = n;
    this.primes = new Heap(primes);
  }
  // è®¡ç®—è¶…çº§ä¸‘æ•°
  getAll() {
    // è¶…çº§ä¸‘æ•°åˆ—è¡¨
    let res = [1];
    let i = 2;
    let primes = this.primes;
    while (res.length < this.n) {
      let arr = Ugly.getPrimes(i);
      let k = 0;
      let l = arr.length;
      for (; k < l; k++) {
        if (!primes.find(arr[k])) {
          break;
        }
      }
      // k === l æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§å°±æ˜¯å½“å‰è¿™ä¸ªæ•°å‹æ ¹æ²¡æœ‰è´¨å› æ•°ï¼›ä¸€ç§æ˜¯æ‰€æœ‰è´¨å› æ•°éƒ½åœ¨æŒ‡å®šåˆ—è¡¨ä¸­
      if (k === l) {
        if (l === 0) {
          if (primes.find(i)) {
            res.push(i);
          }
        } else {
          res.push(i);
        }
      }
      i++;
    }
    return res[this.n - 1];
  }
  // è®¡ç®—æŒ‡å®šæ­£æ•´æ•°nçš„è´¨å› æ•°
  static getPrimes(n) {
    //
    let prime = (n) => {
      // å­˜å‚¨æ‰€æœ‰çš„è´¨å› æ•°
      let arr = [];
      for (let i = 2; i < n / 2 + 1; i++) {
        if (n % i === 0 && !prime(i).length) {
          arr.push(i);
        }
      }
      return arr;
    };
    return prime(n);
  }
}

class Heap {
  constructor(arr) {
    this.data = arr;
    this.max = arr.length;
    this.sort();
  }
  find(val, i = 0) {
    let arr = this.data;
    if (val > arr[i] || i > this.max) {
      return false;
    } else if (val === arr[i]) {
      return val;
    } else {
      return this.find(val, i * 2 + 1) || this.find(val, i * 2 + 2);
    }
  }
  sort() {
    let iArr = this.data;
    let n = iArr.length;
    if (n <= 1) {
      return iArr;
    } else {
      for (let i = Math.floor(n / 2); i >= 0; i--) {
        Heap.maxHeapify(iArr, i, n);
      }
      return iArr;
    }
  }
  // äº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„æ–¹æ³•
  static swap(arr, a, b) {
    if (a === b) {
      return "";
    }
    let c = arr[a];
    arr[a] = arr[b];
    arr[b] = c;
  }
  /**
   * æ„å»ºæœ€å¤§å †çš„è¿‡ç¨‹
   * @param {*} Arr æ•°ç»„
   * @param {*} i  å“ªä¸ªèŠ‚ç‚¹
   * @param {*} size æ•°ç»„æœ‰æ•ˆé•¿åº¦
   */
  static maxHeapify(Arr, i, size) {
    // å·¦èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼‰
    let l = i * 2 + 1;
    // å³èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼‰
    let r = i * 2 + 2;
    let largest = i;
    // çˆ¶èŠ‚ç‚¹iå’Œå·¦èŠ‚ç‚¹lä½œæ¯”è¾ƒå–æœ€å¤§å€¼
    if (l <= size && Arr[l] > Arr[largest]) {
      largest = l;
    }
    // å³èŠ‚ç‚¹å’Œæœ€å¤§å€¼æ¯”è¾ƒ
    if (r <= size && Arr[r] > Arr[largest]) {
      largest = r;
    }
    if (largest !== i) {
      Heap.swap(Arr, i, largest);
      Heap.maxHeapify(Arr, largest, size);
    }
  }
}
export default Ugly;
export { Heap };
```

(3)è¿›é˜¶ç®—æ³•ï¼šè´ªå¿ƒç®—æ³•-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº&æŸ æª¬æ°´æ‰¾é›¶

(4è¿›é˜¶ç®—æ³•: è´ªå¿ƒç®—æ³•ï¼ˆåˆç§°è´ªå©ªç®—æ³•ï¼‰ï¼Œæ˜¯æŒ‡åœ¨å¯¹**é—®é¢˜æ±‚è§£**æ—¶ï¼Œæ€»æ˜¯åšå‡ºåœ¨å½“å‰çœ‹æ¥æ˜¯æœ€å¥½çš„çš„é€‰æ‹©ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä»æ•´ç†æœ€ä¼˜ä¸ŠåŠ ä»¥è€ƒè™‘ï¼Œä»–æ‰€åšå‡ºçš„æ˜¯åœ¨æŸç§æ„ä¹‰ä¸Šçš„**å±€éƒ¨æœ€ä¼˜è§£**ã€‚

è´ªå¿ƒç®—æ³•ä¸æ˜¯å¯¹æ‰€æœ‰é—®é¢˜éƒ½èƒ½å¾—åˆ°æ•´ä½“æœ€ä¼˜è§£ï¼Œå…³é”®æ˜¯è´ªå¿ƒç­–ç•¥çš„é€‰æ‹©ï¼Œé€‰æ‹©çš„è´ªå¿ƒç­–ç•¥å¿…é¡»æ˜¯å…·å¤‡æ— åæ•ˆæ€§ï¼Œå³æŸä¸ªçŠ¶æ€ä»¥å‰çš„è¿‡ç¨‹ä¸ä¼šå½±å“ä»¥åçš„çŠ¶æ€ï¼Œåªä¸å½“å‰çŠ¶æ€æœ‰å…³ã€‚

**ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II:** ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰ã€‚

æ³¨æ„ï¼šä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼š[7,1,5,3,6,4]
è¾“å‡ºï¼š7
è§£é‡Šï¼šåœ¨ç¬¬2å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼=1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬3å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼=5ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1=4ã€‚
éšåï¼Œåœ¨ç¬¬4å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼=3ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬5å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼=6ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 6-3=3ã€‚
```

ç¤ºä¾‹2ï¼š

```
è¾“å…¥ï¼š[1,2,3,4,5]
è¾“å‡ºï¼š4
è§£é‡Šï¼šåœ¨ç¬¬1å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼=1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬5å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼=5ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1=4ã€‚
æ³¨æ„ä½ ä¸èƒ½åœ¨ç¬¬1å¤©å’Œç¬¬2å¤©æ¥è¿è´­ä¹°è‚¡ç¥¨ï¼Œä¹‹åå†å°†å®ƒä»¬å–å‡ºã€‚å› ä¸ºè¿™æ ·å±äºåŒæ—¶å‚ä¸äº†å¤šç¬”äº¤æ˜“ï¼Œä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ã€‚
```

ç¤ºä¾‹3ï¼š

```
è¾“å…¥ï¼š[7,6,4,3,1]
è¾“å‡ºï¼š0
è§£é‡Šï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å®Œæˆäº¤æ˜“ï¼Œæ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º0ã€‚
```

è´ªå¿ƒç®—æ³•ï¼š

**é—®é¢˜ï¼šæœ€å¤§åˆ©æ¶¦**

**ç­–ç•¥1**ï¼šä»æœ€ä½ç‚¹ä¹°å…¥ï¼Œåœ¨æœ€é«˜ç‚¹å–å‡ºï¼ˆè¿½æ±‚å•æ¬¡åˆ©ç›Šï¼‰

**ç­–ç•¥2**ï¼šä»ä½ç‚¹ä¹°å…¥ï¼Œåªè¦å¯ä»¥èµšé’±å°±å–å‡ºï¼›ä¸æ–­ä¹°å–ï¼ˆè¿½æ±‚å¤šæ¬¡åˆ©ç›Šï¼Œå•æ¬¡åˆ©ç›Šä¸å¤Ÿï¼‰

**ç­–ç•¥3**ï¼šä»ä½ç‚¹ä¹°å…¥ï¼Œåˆ°ä»·æ ¼é«˜ç‚¹å–å‡ºï¼Œä¸æ–­ä¹°å–ï¼ˆåœ¨ä¿è¯å•æ¬¡åˆ©ç›Šçš„åŸºç¡€ä¸Šï¼Œå®ç°å¤šæ¬¡äº¤æ˜“ï¼‰

#### 2021å¹´01æœˆ21æ—¥ å‘¨å›› ç¬¬04å‘¨

(1) æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šä¹°å–è‚¡ç¥¨æœ€ä½³æ—¶æœº-ä»£ç å®æ“

```js
export default (prices) => {
  // ç”¨æ¥ä¿å­˜åˆ©æ¶¦
  let count = 0;
  for (let i = 0, len = prices.length; i < len; i++) {
    for (let j = i; j < len - 1; j++) {
      if (prices[j + 1] > prices[j]) {
        count += prices[j + 1] - prices[j];
        i = j;
      } else {
        i = j;
        break;
      }
    }
  }
  return count;
};
```

(2) æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šæŸ æª¬æ°´æ‰¾é›¶-åŸç†è®²è§£ï¼Œåœ¨æŸ æª¬æ°´æ‘Šä½ä¸Šï¼Œæ¯ä¸€æ¯æŸ æª¬æ°´çš„å”®ä»·ä¸º 5 ç¾å…ƒã€‚é¡¾å®¢æ’é˜Ÿè´­ä¹°ä½ çš„äº§å“ï¼Œï¼ˆæŒ‰è´¦å• bills æ”¯ä»˜çš„é¡ºåºï¼‰ä¸€æ¬¡è´­ä¹°ä¸€æ¯ã€‚

æ¯ä½é¡¾å®¢åªä¹°ä¸€æ¯æŸ æª¬æ°´ï¼Œç„¶åå‘ä½ æ”¯ä»˜5ç¾å…ƒã€10ç¾å…ƒæˆ–20ç¾å…ƒã€‚ä½ å¿…é¡»ç»™æ¯ä¸ªé¡¾å®¢æ­£ç¡®æ‰¾é›¶ï¼Œä¹Ÿå°±æ˜¯è¯´å‡€äº¤æ˜“æ˜¯æ¯ä½é¡¾å®¢å‘ä½ æ”¯ä»˜5ç¾å…ƒã€‚

æ³¨æ„ï¼Œä¸€å¼€å§‹ä½ æ‰‹å¤´æ²¡æœ‰ä»»ä½•é›¶é’±ã€‚

å¦‚æœä½ èƒ½ç»™æ¯ä½é¡¾å®¢æ­£ç¡®æ‰¾é›¶ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼š[5,5,5,10,20]
è¾“å‡ºï¼štrue
è§£é‡Šï¼š
å‰3ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æŒ‰é¡ºåºæ”¶å–3å¼ 5ç¾å…ƒçš„é’ç¥¨ã€‚
ç¬¬4ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æ”¶å–ä¸€å¼ 10ç¾å…ƒçš„é’ç¥¨ï¼Œå¹¶è¿”å›5ç¾å…ƒã€‚
ç¬¬5ä½é¡¾å®¢é‚£é‡Œï¼Œæˆ‘ä»¬æ‰¾è¿˜ä¸€å¼ 10ç¾å…ƒçš„é’ç¥¨å’Œä¸€å¼ 5ç¾å…ƒçš„é’ç¥¨ã€‚
ç”±äºæ‰€æœ‰å®¢æˆ·éƒ½å¾—åˆ°äº†æ­£ç¡®çš„æ‰¾é›¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè¾“å‡º trueã€‚
```

é—®é¢˜ï¼šæ‰¾é›¶é’±

ç­–ç•¥1ï¼šç»™é’±æ‰¾é›¶ï¼Œä¸åŒºåˆ†é‡‘é¢ç›´åˆ°æ‰¾åˆ°è¶³å¤Ÿçš„é›¶é’±ï¼ˆè¿½æ±‚å•è¯æ‰¾é›¶ï¼‰

ç­–ç•¥2ï¼šç»™é’±æ‰¾é›¶ï¼Œä¼˜å…ˆç»™é‡‘é¢å¤§çš„é›¶é’±ï¼Œå°½é‡æŠŠé›¶é’±æ”¾åœ¨æ‰‹é‡Œï¼ˆè¿½æ±‚å¤šæ¬¡æ‰¾é›¶ï¼‰

ç¤ºä¾‹2ï¼š

```
è¾“å…¥ï¼š[5,5,10]
è¾“å‡ºï¼štrue
```

ç¤ºä¾‹3ï¼š

```
è¾“å…¥ï¼š[10,10]
è¾“å‡ºï¼šfalse
```

ç¤ºä¾‹4ï¼š

```
è¾“å…¥ï¼š[5,5,10,10,20]
è¾“å‡ºï¼šfalse
```

(3)æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šæŸ æª¬æ°´æ‰¾é›¶-ä»£ç æ¼”ç¤º

```js
export default (input) => {
  // è¡¨ç¤ºè‡ªå·±çš„é’±ç®±ï¼ˆç”¨äºå­˜å‚¨é›¶é’±ï¼‰
  let hand = [];
  // åˆ¤æ–­æ˜¯å¦æœ‰é¡¾å®¢è¿˜åœ¨
  while (input.length) {
    // å–å‡ºå½“å‰æ’åœ¨æœ€å‰é¢é¡¾å®¢çš„é’±
    let money = input.shift();
    // è¿™ç§æƒ…å†µä¸éœ€è¦æ‰¾é›¶é’±
    if (money === 5) {
      hand.push(money);
    } else {
      // æ‰‹é‡Œçš„é›¶é’±è¦é™åºæ’åˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤§çš„é¢å€¼çš„é’±æ”¾åœ¨æœ€å‰é¢
      hand.sort((a, b) => b - a);
      // é¡¾å®¢çš„é’±å‡å»é¥®æ–™çš„é’±å°±æ˜¯éœ€è¦æ‰¾ç»™é¡¾å®¢çš„é›¶é’±
      let change = money - 5;
      for (let i = 0, len = hand.length; i < len; i++) {
        if (hand[i] <= change) {
          change -= hand[i];
          hand.splice(i, 1);
          // åˆ é™¤äº†å…ƒç´ ï¼Œæ•°ç»„çš„é•¿åº¦å‘ç”Ÿäº†å˜åŒ–ï¼Œè¦ç»´æŒåˆšæ‰çš„iä¸å˜
          i--;
        }
        if (change === 0) {
          break;
        }
      }
      // æ²¡æœ‰è¶³å¤Ÿçš„é’±æ‰¾ç»™é¡¾å®¢
      if (change !== 0) {
        return false;
      } else {
        // é¡¾å®¢çš„é’±å­˜èµ·æ¥
        hand.push(money);
      }
    }
  }
  return true;
};
```

#### 2021å¹´01æœˆ22æ—¥ å‘¨äº” ç¬¬04å‘¨

(1) æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼šè¿›é˜¶ç®—æ³•-åŠ¨æ€è§„åˆ’ä¹‹ä¸åŒè·¯å¾„II å’Œ K ç«™ä¸­è½¬å†…æœ€ä¾¿å®œçš„èˆªç­

åŠ¨æ€è§„åˆ’ä¸‰ä¸ªé‡è¦æ¦‚å¿µï¼šåŠ¨æ€è½¬ç§»æ–¹ç¨‹ã€æœ€ä¼˜å­ç»“æ„ã€è¾¹ç•Œ

ä¸åŒè·¯å¾„IIï¼šä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª m x n ç½‘æ ¼çš„å·¦ä¸Šè§’ï¼ˆèµ·ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°çš„ Startï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾åˆ°è¾¾ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸º Finishï¼‰ã€‚ç°åœ¨è€ƒè™‘ç½‘æ ¼ä¸­æœ‰éšœç¢ç‰©ã€‚é‚£ä¹ˆä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’å°†ä¼šæœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿ

| Start |      |      |      |      |      |        |
| :---: | ---- | ---- | ---- | ---- | ---- | :----: |
|       |      |      |      |      |      |        |
|       |      |      |      |      |      | Finish |

ç½‘æ ¼ä¸­çš„éšœç¢ç‰©å’Œç©ºä½ç½®åˆ†åˆ«ç”¨1å’Œ0æ¥è¡¨ç¤ºã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼š
[
 [0,0,0],
 [0,1,0],
 [0,0,0]
]
è¾“å‡ºï¼š2
è§£é‡Šï¼š3x3 ç½‘æ ¼çš„æ­£ä¸­é—´æœ‰ä¸€ä¸ªéšœç¢ç‰©ã€‚ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’ä¸€å…±æœ‰2æ¡ä¸åŒçš„è·¯å¾„ï¼š
1.å‘å³ -> å‘å³ -> å‘ä¸‹ -> å‘ä¸‹
2.å‘ä¸‹ -> å‘ä¸‹ -> å‘å³ -> å‘å³
```

mxnï¼šmè¡Œnåˆ—çš„çŠ¶æ€æ–¹ç¨‹æ˜¯ F(mxn) = F(m-1xn) + F(mxn-1)

(2)ä¸åŒè·¯å¾„II-ä»£ç å®æ“ï¼š

```js
export default (arr, m, n) => {
  let dp = (m, n) => {
    // m=2,n=2 çš„è¾¹ç•Œ
    if (m === 2 && n === 2) {
      return arr[1][1] || arr[1][0] + arr[0][1] === 2
        ? 0
        : arr[1][0] === 1 || arr[0][1] === 1
        ? 1
        : 2;
    } else if (m < 2 || n < 2) {
      if (m < 2) {
        // å•è¡Œæœ‰1å°±è¿”å›0ï¼Œæ²¡æœ‰1è¿”å›1
        return arr[m - 1].includes(1) ? 0 : 1;
      } else {
        // å•åˆ—ä¸èƒ½æœ‰éšœç¢ç‰©(1)æœ‰å®ƒè¿”å›0ï¼Œæ²¡æœ‰1è¿”å›1
        for (let i = 0; i < m; i++) {
          if (arr[i][0] === 1) {
            return 0;
          }
        }
        return 1;
      }
    } else {
      return dp(m - 1, n) + dp(m, n - 1);
    }
  };
  return dp(m, n);
};
```

(3) Kç«™ä¸­è½¬å†…æœ€ä¾¿å®œçš„èˆªç­ï¼šæœ‰nä¸ªåŸå¸‚é€šè¿‡mä¸ªèˆªç­è¿æ¥ã€‚æ¯ä¸ªèˆªç­éƒ½ä»åŸå¸‚ u å¼€å§‹ï¼Œä»¥ä»·æ ¼ w æŠµè¾¾ vã€‚

ç°åœ¨ç»™å®šæ‰€æœ‰çš„åŸå¸‚å’Œèˆªç­ï¼Œä»¥åŠå‡ºå‘åŸå¸‚ src å’Œ ç›®çš„åœ° dstï¼Œä½ çš„ä»»åŠ¡æ˜¯æ‰¾åˆ°ä» src åˆ° dst æœ€å¤šç»è¿‡ k ç«™ä¸­è½¬çš„æœ€ä¾¿å®œçš„ä»·æ ¼ã€‚

å¦‚æœæ²¡æœ‰è¿™æ ·çš„è·¯çº¿ï¼Œåˆ™è¾“å‡º -1ã€‚

ç¤ºä¾‹1ï¼š

```
è¾“å…¥ï¼šn=3,edges=[[0,1,100],[1,2,100],[0,2,500]],src=0,dst=2,k=1
è¾“å‡ºï¼š200
è§£é‡Šï¼š0 -> 1 -> 2 200; 0 -> 2 500
```

ç¤ºä¾‹2ï¼š

```
è¾“å…¥ï¼šn=3,edges=[[0,1,100],[1,2,100],[0,2,500]],src=0,dst=2,k=0
è¾“å‡ºï¼š500
è§£é‡Šï¼š0 -> 1 -> 2 200; 0 -> 2 500
```

åŠ¨æ€è½¬ç§»æ–¹ç¨‹ï¼šF(src,dst,k) = Min(F(src,dst-1,k-1) + F(dst-1,dst,1))

(4) kç«™ä¸­è½¬ç«™-ä»£ç å®æ“

```js
export default (src, dst, k) => {
  // å¯¹nä¸ªåŸå¸‚mä¸ªèˆªç­åšé£è¡Œè¯´æ˜
  let fights = [
    [0, 1, 100],
    [1, 2, 100],
    [0, 2, 500],
  ];
  let cheap = (src, dst, k) => {
    // æ‰¾åˆ° dst çš„å‰ä¸€ç«™
    let prev = fights.filter((item) => item[1] === dst);
    let min = Math.min.apply(
      null,
      prev.map((item) => {
        // ä» dst å¾€å‰æ‰¾ï¼Œæ‰¾åˆ°äº†èµ·å§‹åŸå¸‚
        if (item[0] === src && k > -1) {
          return item[2];
        } else if (k === 0 && item[0] !== src) {
          return Number.MAX_SAFE_INTEGER;
        } else {
          return item[2] + cheap(src, item[0], k - 1);
        }
      })
    );
    return min;
  };
  return cheap(src, dst, k) || -1;
};
```

(5) è¯¾ç¨‹æ€»ç»“ï¼š

åŸºç¡€ç®—æ³•ï¼š

| å¸¸è§ç±»å‹ï¼šå­—ç¬¦ä¸²ã€æ•°ç»„ã€æ­£åˆ™ |
| ---------------------------- |
| å¸¸è§é¢˜å‹ï¼šæŸ¥é‡ã€æ’åºã€é€’å½’   |
| çŸ¥è¯†ç‚¹ï¼šåŸºç¡€APIã€å¸¸ç”¨æŠ€å·§    |

æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼š

| å¸¸è§ç»“æ„ï¼šæ ˆã€é˜Ÿåˆ—ã€é“¾è¡¨ã€çŸ©é˜µã€äºŒå‰æ ‘ã€å † |
| ------------------------------------------ |
| å¸¸è§é¢˜å‹ï¼šç»“æ„å®ç°ã€æŸ¥æ‰¾ã€æ’åºã€æ‹“å±•åº”ç”¨   |
| çŸ¥è¯†ç‚¹ï¼šåŸç†ã€å®ç°ã€å®æˆ˜æ€æƒ³               |

(6) å‰ç«¯äººçš„å±æœºå¦‚ä½•ç ´è§£é€‰

é€‰æ‹©å’Œè¢«é€‰æ‹©éƒ½æ˜¯ä¸€ç§èƒ½åŠ›ã€‚å¯ä»¥é€‰æ‹©æ˜¯ä¸€ç§èµ„æœ¬ï¼Œå¯ä»¥è¢«é€‰æ‹©æ˜¯ä¸€ç§èµ„å†ï¼Œæ— è®ºæ˜¯å“ªç§éƒ½å¯ä»¥æˆå°±ä¸€ç•ªäº‹ä¸šã€‚ä¸ç„¶å±æœºä¼šå¤§ä¸€äº›ã€é—æ†¾ä¹Ÿä¼šéšä¹‹è€Œæ¥ã€‚ç ´é™¤å±æœºï¼šç§¯ç´¯å¯ä»¥é€‰æ‹©çš„èµ„æœ¬ or å¢åŠ è¢«é€‰æ‹©çš„èµ„å†ã€‚

ä¼šå·¥ä½œ & ä¼šå­¦ä¹ ï¼šå…¥é—¨çº§ - å¦‚ä½•å­¦ä¹ ï¼Ÿå¦‚ä½•é¢è¯•ï¼Ÿå¦‚ä½•æå‡ï¼Ÿé£é™©æœ€é«˜ã€‚

å…¥é—¨çº§ï¼š

å¦‚ä½•å­¦ä¹ ï¼Ÿäººç¾¤ï¼šå­¦ç”Ÿã€è½¬è¡Œã€è‡ªå­¦ï¼›ç›®æ ‡ï¼šå­¦ä¹ åŸºç¡€çŸ¥è¯†ï¼›é€”å¾„ï¼šç½‘ç»œåšå®¢ã€è§†é¢‘è¯¾ç¨‹ã€åŸ¹è®­ç­ï¼›æ–¹æ³•ï¼šä¸´æ‘¹ï¼›è‡ªæµ‹ï¼šæ˜¯ä¸æ˜¯èƒ½å¤Ÿç‹¬ç«‹è§£å†³é—®é¢˜ï¼›å¿ƒæ€ï¼šè„šè¸å®åœ°ã€åˆ‡è«æŠ•æœºå–å·§ã€‚

å¦‚ä½•é¢è¯•ï¼Ÿç›®æ ‡ï¼šå·¥ä½œæœºä¼šï¼›å‡†å¤‡ï¼šåŸºç¡€çŸ¥è¯†+å®æˆ˜ç»éªŒï¼›æŠ€å·§ï¼šåŸºç¡€+èƒ½åŠ›+æ½œåŠ›ï¼›è‡ªæµ‹ï¼šåˆ·é¢˜+é¢ç»+æŠ€æœ¯åˆ†æã€‚åŸºç¡€çŸ¥è¯†å¥½ä¸ç­‰äºè¦æ‡‚æ‰€æœ‰çš„çŸ¥è¯†ï¼›æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„çŸ¥è¯†ç›²åŒºã€‚

å¦‚ä½•æå‡ï¼Ÿç›®æ ‡ï¼šæå‡è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼›æ–¹æ³•ï¼šå¤šçœ‹ã€å¤šå¬ã€å¤šåšã€å¤šæ€è€ƒï¼Œä¸æ”¾è¿‡ä»»ä½•ä¸€ä¸ªæœºä¼šï¼›å¿Œè®³ï¼šè‡ªè´Ÿã€å¤šé—®é¢˜ã€æ‡’æ•£ï¼›è‡ªæµ‹ï¼šæ˜¯å¦èƒ½ç‹¬ç«‹è§£å†³é—®é¢˜ã€‚

ä¸­é«˜çº§ï¼šå¦‚ä½•å­¦ä¹ ï¼Ÿå¦‚ä½•æˆé•¿ï¼Ÿå¦‚ä½•æ™‹å‡ï¼Ÿ

å¦‚ä½•å­¦ä¹ ï¼ŸèƒŒæ™¯ï¼šå­¦çš„å¾ˆç´¯ï¼›åŸåˆ™ï¼šå…ˆå°‘åå¤šã€å…ˆç²¾åå¹¿ï¼›æ–¹æ³•ï¼šå¹³è¡¡å­¦ä¹ ã€å·¥ä½œã€ç”Ÿæ´»çš„æ—¶é—´ï¼Œå¤šåˆ©ç”¨ç¤¾åŒºçš„åŠ›é‡ï¼›

å¦‚ä½•æˆé•¿ï¼Ÿå®šä¹‰ï¼šæŠ€æœ¯ã€åšäº‹ï¼›æ–¹æ³•ï¼šè‡ªé©±åŠ¨ã€æ•¢äºæŒ‘æˆ˜ã€æ‰¿æ‹…è´£ä»»ï¼›è‡ªæµ‹ï¼šæŠ€æœ¯æ¶æ„ã€ç‹¬ç«‹åšäº‹ã€å½¼æ­¤æˆå°±ã€‚

å¦‚ä½•æ™‹å‡ï¼Ÿç›®æ ‡ï¼šåŠ è–ªã€æ™‹çº§ï¼›æ–¹æ³•ï¼šå°‘è¯´ã€å¤šåšã€ä»»åŠ³ä»»æ€¨ã€æœ‰æ•ˆæ²Ÿé€šã€æ‹’ç»å¹³åº¸ã€å…¨é¢å‘å±•ï¼›å¿ƒæ€ï¼šå…ˆä»˜å‡ºå†å›æŠ¥ã€ä¸ªäººæœä»é›†ä½“ã€å­¦ä¼šå®šä½å’Œè¡¥ä½ã€è¶³å¤Ÿè€å¿ƒã€‚

(7) TS+Reactæ‰“é€ ç»„ä»¶åº“ï¼š

(8) WebRTCå­¦ä¹ ï¼š

ç‰¹ç‚¹ï¼šGoogleå¼€æºã€è·¨å¹³å°ã€ç”¨äºæµè§ˆå™¨ã€å®æ—¶ä¼ è¾“ã€éŸ³è§†é¢‘å¼•æ“ï¼›

åº”ç”¨é¢†åŸŸï¼šéŸ³è§†é¢‘ä¼šè®®åœ¨çº¿æ•™è‚²ã€ç…§ç›¸æœºã€éŸ³ä¹æ’­æ”¾å™¨ã€å…±äº«è¿œç¨‹æ¡Œé¢ã€å½•åˆ¶ã€å³æ—¶é€šè®¯å·¥å…·ã€P2Pç½‘ç»œåŠ é€Ÿã€æ–‡ä»¶ä¼ è¾“å·¥å…·ã€æ¸¸æˆã€å®æ—¶äººè„¸è¯†åˆ«ï¼›

#### 2021å¹´01æœˆ23æ—¥ å‘¨å…­ 04å‘¨

(1) WebRTCå­¦ä¹ ï¼šå­¦ä¹ æ”¶è·ï¼ŒWebRTC API çš„ä½¿ç”¨ï¼›WebRTC å·¥ä½œåŸç†ï¼›ä¿¡ä»¤æœåŠ¡å™¨çš„è®¾è®¡ä¸æ­å»ºï¼›å®ç°1:1å®æ—¶äº’åŠ¨ç›´æ’­ç³»ç»Ÿã€‚

(2) WebRTC å…¥é—¨ä¸å®æˆ˜ï¼šWebRTC ä»‹ç»

WebRTC æ¦‚è¿°ï¼š

- éŸ³è§†é¢‘å¤„ç†+å³æ—¶é€šè®¯çš„å¼€æºåº“ï¼›
- 2010å¹´ Google å°†å…¶å¼€æºï¼›
- å®ƒæ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„å¤šåª’ä½“æ¡†æ¶ï¼Œè·¨å¹³å°ï¼›

WebRTCåº”ç”¨ï¼š

- éŸ³è§†é¢‘å®æ—¶äº’åŠ¨ï¼›æ¸¸æˆã€å³æ—¶é€šè®¯ã€æ–‡ä»¶ä¼ è¾“ç­‰ç­‰ï¼›å®ƒæ˜¯ä¸€ä¸ªç™¾å®ç®±ï¼Œä¼ è¾“ã€éŸ³è§†é¢‘å¤„ç†ï¼ˆå›éŸ³æ¶ˆé™¤ã€é™å™ªç­‰ï¼‰

èƒ½å­¦åˆ°ä»€ä¹ˆï¼š

- éŸ³è§†é¢‘è®¾å¤‡è®¿é—®ä¸ç®¡ç†ï¼›éŸ³è§†é¢‘æ•°æ®çš„é‡‡é›†ï¼›æ•°æ®çš„ä¼ è¾“ä¸å®æ—¶äº’åŠ¨ï¼›WebRTC çš„å·¥ä½œæœºåˆ¶ï¼›

(3) TS+Reactç»„ä»¶åº“ï¼šå®‰è£…å’Œåˆè¯•TypeScript

```bash
# å…¨å±€å®‰è£…
npm install -g typescript@3.7.2
# æŸ¥çœ‹ç‰ˆæœ¬å·
tsc -v 
```

ï¼ˆ4ï¼‰TS+Reactç»„ä»¶åº“ï¼šåŸºç¡€ç±»å‹ï¼Œ undefined å’Œ null æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹

ï¼ˆ5ï¼‰TS+Reactç»„ä»¶åº“ï¼šany ç±»å‹å’Œè”åˆç±»å‹ï¼Œå°½å¯èƒ½æ…ç”¨ï¼Œ

```typescript
//any ç±»
let notSure: any = 4
notSure = 'maybe it is a string'
notSure = true
notSure.myName
notSure.getName()
```

```typescript
// union ç±»å‹
let numberOrString: number | string = 234
numberOrString = 'abc'
```

ï¼ˆ6ï¼‰TS+Reactç»„ä»¶åº“ï¼šArray å’Œ Tuple(å…ƒç»„)

```typescript
// Array
let arrayOfNumber: number[] = [1, 2, 3, 4]
arrayOfNumber.push(5)
// Tuple å…ƒç»„æ˜¯é™å®šäº†æ•°æ®ç±»å‹çš„ä¸€ç§æ•°ç»„ï¼Œå¿…é¡»æ‰€æœ‰ç±»å‹éƒ½æœ‰
let user: [string, number] = ['viking', 1]
```

ï¼ˆ7ï¼‰TS+Reactç»„ä»¶åº“ï¼šInterfaceæ¥å£ï¼Œå®šä¹‰å¯¹è±¡çš„ç±»å‹ 

 - å¯¹å¯¹è±¡çš„å½¢çŠ¶ï¼ˆshapeï¼‰ è¿›è¡Œæè¿°
 - å¯¹ç±»ï¼ˆclassï¼‰ è¿›è¡ŒæŠ½è±¡
 - Duck Typingï¼ˆé¸­å­ç±»å‹ ï¼‰

```typescript
// interface
interface Person {
    readonly id: number;
    name: string;
    age?: number;
}
let viking: Person = {
    id: 1234,
    name: 'viking',
    age: 20
}
```

å¯é€‰å±æ€§ ï¼ŸåŠ åœ¨å±æ€§åé¢ï¼›å¯è¯»å±æ€§ï¼Œreadonly åŠ åœ¨å±æ€§å‰é¢ï¼Œreadonly ç”¨åœ¨å¯¹è±¡å±æ€§ä¸Šï¼Œè€Œ const  ç”¨åœ¨å˜é‡ä¸Šï¼›

ï¼ˆ8ï¼‰TS+Reactç»„ä»¶åº“ï¼šå‡½æ•°å’Œç±»å‹åˆ¤æ–­

```typescript
// å‡½æ•°å£°æ˜
function add(x: number, y: number, z?: number): number {
    if (typeof z === 'number') {
        return x + y + z
    } else {
        return x + y
    }
}
let result = add(2, 3, 5)
```

å¯é€‰å‚æ•°åä¸èƒ½åŠ ç¡®å®šçš„å‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼›ä¹Ÿå¯ä»¥æ·»åŠ é»˜è®¤å‚æ•°ã€‚

```typescript
// å‡½æ•°è¡¨è¾¾å¼
function add(x: number, y: number, z: number = 10): number {
    if (typeof z === 'number') {
        return x + y + z
    } else {
        return x + y
    }
}
let result = add(2, 3)
```

```typescript
// å‡½æ•°è¡¨è¾¾å¼,ç±»å‹æ¨æ–­
const add = function (x: number, y: number, z: number = 10): number {
    if (typeof z === 'number') {
        return x + y + z
    } else {
        return x + y
    }
}
const add2: (x: number, y: number, z?: number) => number = add 
```

typescript å¯ä»¥åœ¨æ²¡æœ‰æ˜ç¡®æŒ‡å®šç±»å‹æ—¶ï¼Œæ¨æ–­å‡ºè¦ä½¿ç”¨çš„ç±»å‹ã€‚

#### 2021å¹´01æœˆ24æ—¥ å‘¨æ—¥ 04å‘¨

(1) WebRTCå­¦ä¹ ï¼šWebRTC åŸç†ä¸æ¶æ„ï¼Œ ç½‘é¡µç«¯å’Œæµè§ˆå™¨ç«¯ã€‚å…¶ä¸­æµè§ˆå™¨ç«¯æœ‰åŒ…æ‹¬éŸ³é¢‘å¼•æ“ï¼ˆéŸ³é¢‘é‡‡é›†å’Œæ¸²æŸ“ï¼‰ã€è§†é¢‘å¼•æ“ï¼ˆè§†é¢‘é‡‡é›†ï¼‰ã€ä¼ è¾“å±‚ï¼ˆæ•°æ®çš„è¾“å…¥è¾“å‡ºï¼‰ã€‚

(2)  WebRTCå­¦ä¹ ï¼š WebRTCçš„ç›®å½•ç»“æ„

| ç¼–å· | ç›®å½•            | åŠŸèƒ½                                                   |
| ---- | --------------- | ------------------------------------------------------ |
| 01   | api             | webrtcæ¥å£å±‚ï¼Œæµè§ˆå™¨éƒ½æ˜¯é€šè¿‡è¯¥æ¥å£è°ƒç”¨webrtc           |
| 02   | call            | æ•°æ®æµçš„ç®¡ç†å±‚ï¼Œcallä»£è¡¨åŒä¸€ä¸ªç«¯ç‚¹çš„æ‰€æœ‰æ•°æ®çš„æµå…¥æµå‡º |
| 03   | video           | ä¸è§†é¢‘ç›¸å…³çš„é€»è¾‘                                       |
| 04   | audio           | ä¸éŸ³é¢‘ç›¸å…³çš„é€»è¾‘                                       |
| 05   | common_audio    | éŸ³é¢‘ç®—æ³•ç›¸å…³                                           |
| 06   | common_video    | è§†é¢‘ç®—æ³•ç›¸å…³                                           |
| 07   | media           | ä¸å¤šåª’ä½“ç›¸å…³çš„é€»è¾‘å¤„ç†ï¼Œå¦‚ç¼–è§£ç çš„é€»è¾‘å¤„ç†             |
| 08   | logging         | æ—¥å¿—ç›¸å…³                                               |
| 09   | module          | æœ€é‡è¦çš„ç›®å½•ï¼Œå­æ¨¡å—                                   |
| 10   | pc              | peer connection,è¿æ¥ç›¸å…³çš„é€»è¾‘å±‚                       |
| 11   | p2p             | ç«¯å¯¹ç«¯ç›¸å…³ä»£ç ï¼Œstunï¼Œturn                             |
| 12   | rtc_base        | åŸºç¡€ä»£ç ï¼Œå¦‚çº¿ç¨‹ã€é”ç›¸å…³çš„ç»Ÿä¸€æ¥å£ä»£ç                  |
| 13   | rtc_tool        | éŸ³è§†é¢‘åˆ†æç›¸å…³çš„å·¥å…·ä»£ç                                |
| 14   | tool_webrtc     | webrtcæµ‹è¯•ç›¸å…³çš„å·¥å…·ä»£ç ï¼Œå¦‚ç½‘ç»œæ¨¡æ‹Ÿå™¨                 |
| 15   | system_warppers | ä¸å…·ä½“æ“ä½œç³»ç»Ÿç›¸å…³çš„ä»£ç ã€‚å¦‚cpuç‰¹æ€§ï¼ŒåŸå­æ“ä½œç­‰        |
| 16   | stats           | å­˜æ”¾å„ç§æ•°æ®ç»Ÿè®¡ç›¸å…³çš„ç±»                               |
| 17   | sdk             | å­˜æ”¾androidå’Œioså±‚ä»£ç ã€‚å¦‚è§†é¢‘çš„é‡‡é›†ã€æ¸²æŸ“ç­‰ã€‚         |

webrtc modules ç›®å½•

| ç¼–å· | ç›®å½•                     | åŠŸèƒ½                                 |
| ---- | ------------------------ | ------------------------------------ |
| 01   | audio_coding             | éŸ³é¢‘ç¼–è§£ç ç›¸å…³ä»£ç                    |
| 02   | audio_device             | éŸ³é¢‘é‡‡é›†ä¸éŸ³é¢‘æ’­æ”¾ç›¸å…³ä»£ç            |
| 03   | audio_mixer              | æ··éŸ³ç›¸å…³ä»£ç                          |
| 04   | audio_processing         | éŸ³é¢‘å‰åå¤„ç†çš„ç›¸å…³ä»£ç                |
| 05   | bitrate_controller       | ç ç‡æ§åˆ¶ç›¸å…³çš„ä»£ç                    |
| 06   | congestion_controller    | æµæ§åˆ¶ç›¸å…³çš„ä»£ç                      |
| 07   | desktop_capture          | æ¡Œé¢é‡‡é›†ç›¸å…³çš„ä»£ç                    |
| 08   | pacing                   | ç ç‡æ¢æµ‹åŠå¹³æ»‘å¤„ç†ç›¸å…³çš„ä»£ç          |
| 09   | remote_bitrate_estimator | è¿œç«¯ç ç‡ä¼°ç®—ç›¸å…³çš„ä»£ç                |
| 10   | rtp_rtcp                 | rtp/rtcpåè®®ç›¸å…³çš„ä»£ç                |
| 11   | video_capture            | è§†é¢‘é‡‡é›†ç›¸å…³çš„ä»£ç                    |
| 12   | video_coding             | è§†é¢‘ç¼–è§£ç ç›¸å…³çš„ä»£ç                  |
| 13   | video_processing         | è§†é¢‘å‰åå¤„ç†ç›¸å…³çš„ä»£ç ï¼Œä¾‹å¦‚äººè„¸è¯†åˆ« |

(4)TS+Reactç»„ä»¶åº“ï¼šç±» Classï¼Œç¬¬ä¸€éƒ¨åˆ†

- ç±»(Class) :å®šä¹‰äº†ä¸€åˆ‡äº‹ç‰©çš„æŠ½è±¡ç‰¹ç‚¹
- å¯¹è±¡ï¼ˆObjectï¼‰:ç±»çš„å®ä¾‹
- é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€

```bash
# locally in your project
npm i -D ts-node
npm i -D typescript
# or globally with typescript
npm i -g ts-node
npm i -g typescript

# åœ¨æ§åˆ¶å°
ts-node class.ts
```

(5)TS+Reactç»„ä»¶åº“ï¼šç±» Classï¼Œç¬¬äºŒéƒ¨åˆ†ï¼Œä¿®é¥°ç¬¦ publicï¼ˆå…¬å…±å±æ€§ï¼‰ / privateï¼ˆç§æœ‰å±æ€§,å­ç±»æ— æ³•è®¿é—®ï¼‰ / protectedï¼ˆå—ä¿æŠ¤çš„å±æ€§ï¼Œå­ç±»å¯ä»¥è®¿é—®è¯¥å±æ€§ï¼‰;readonly ï¼ˆåªè¯»ä¸å¯å†™å±æ€§ï¼‰

 static è¡¨ç¤ºé™æ€å±æ€§æˆ–æ–¹æ³•ï¼Œæ— éœ€å®ä¾‹åŒ–å³å¯è®¿é—®ï¼Œä¸å®ä¾‹ä¹Ÿæ— å…³ç³»ã€‚

(6)TS+Reactç»„ä»¶åº“ï¼šç±»å’Œæ¥å£

```typescript
interface Radio {
    switchRadio(): void;
}
interface Battery {
    checkBatteryStatus();
}
interface RadioWithBattery extends Radio {
    checkBatteryStatus();
}
class Car implements Radio {
    switchRadio() {

    }
}
class Cellphone implements RadioWithBattery {
    switchRadio() {

    }
    checkBatteryStatus() {

    }
}
```

(7)TS+Reactç»„ä»¶åº“ï¼šæšä¸¾ï¼ˆEnumï¼‰

```typescript
enum Direction {
    Up = 10,
    Down,
    Left,
    Right,
}
console.log(Direction.Up)
console.log(Direction.Down)
console.log(Direction.Left)
console.log(Direction.Right)
console.log(Direction[10])
```

```typescript
enum Direction {
    Up = 'UP',
    Down = 'DOWN',
    Left = 'LEFT',
    Right = 'RIGHT',
}
const value = 'UP'
if (value === Direction.Up) {
    console.log('go up!')
}
```

ä½¿ç”¨å¸¸é‡æšä¸¾å¯ä»¥æå‡æ€§èƒ½ã€‚

```typescript
const enum Direction {
    Up = 'UP',
    Down = 'DOWN',
    Left = 'LEFT',
    Right = 'RIGHT',
}
const value = 'UP'
if (value === Direction.Up) {
    console.log('go up!')
}
```

(7)TS+Reactç»„ä»¶åº“ï¼šæ³›å‹ï¼Œç¬¬ä¸€éƒ¨åˆ†ã€‚æ³›å‹æ˜¯ TS ä¸­æœ€éš¾çš„éƒ¨åˆ†ã€‚

```typescript
function echo<T>(arg: T): T {
    return arg
}
// const str: string = 'str'
const result = echo(123)

function swap<T, U>(tuple: [T, U]): [U, T] {
    return [tuple[1], tuple[0]]
}
// const result2:[number,string]
const result2 = swap(['string', 123]) 
```

æ³›å‹å°±åƒä¸€ä¸ªå ä½ç¬¦æˆ–è€…æ˜¯ä¸€ä¸ªå˜é‡ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠå®šä¹‰å¥½çš„ç±»å‹ï¼Œåƒå‚æ•°ä¸€æ ·ä¼ å…¥ï¼Œç„¶åå®ƒå¯ä»¥åŸå°ä¸å˜çš„è¾“å‡ºã€‚

#### 2021å¹´01æœˆ25æ—¥ å‘¨ä¸€ 05å‘¨

(1) WebRTCå­¦ä¹ ï¼šWebRTCè¿è¡Œæœºåˆ¶ï¼ŒTrack(è½¨) & MediaStreamï¼ˆæµï¼‰

WebRTCé‡è¦çš„ç±»ï¼š

- MediaStream
- RTCPeerConnectionï¼ˆæœ€é‡è¦çš„ç±»ï¼‰
- RTCDataChannelï¼ˆééŸ³è§†é¢‘çš„ç±»ï¼‰

(2)TS+Reactç»„ä»¶åº“ï¼šæ³›å‹-çº¦æŸæ³›å‹

```typescript
// çº¦æŸæ³›å‹-æ–¹æ¡ˆä¸€,è¿”å›ç»“æœåªèƒ½æ˜¯æ•°ç»„
function echoWithArr<T>(arg: T[]): T[] {
    console.log(arg.length)
    return arg
}
const arrs = echoWithArr([1, 2, 3])
// çº¦æŸæ³›å‹-æ–¹æ¡ˆäºŒ,é€šè¿‡ extends å’Œ interface è®¾ç½®çº¦æŸæ¡ä»¶
interface IWithLength {
    length: number;
}
function echoWithLength<T extends IWithLength>(arg: T): T {
    console.log(arg.length)
    return arg
}
const str = echoWithLength('str')
const obj = echoWithLength({ length: 10, width: 10 })
const arr2 = echoWithLength([1, 2, 3])
```

(3)TS+Reactç»„ä»¶åº“ï¼šæ³›å‹-ç±»å’Œæ¥å£

```typescript
// ç±»ä½¿ç”¨æ³›å‹çº¦æŸ
class Queue<T> {
    private data = []
    push(item: T) {
        return this.data.push(item)
    }
    pop(): T {
        return this.data.shift()
    }
}
const queque = new Queue<number>()
queque.push(1)
console.log(queque.pop().toFixed())

const queque2 = new Queue<string>()
queque2.push('str')
console.log(queque2.pop().length)
```

```typescript
// æ¥å£æ·»åŠ æ³›å‹
interface KeyPair<T, U> {
    key: T;
    value: U;
}
let kp1: KeyPair<number, string> = { key: 123, value: 'str' }
let kp2: KeyPair<string, number> = { key: 'test', value: 123 }

let arr: number[] = [1, 2, 3]
let arrTwo: Array<number> = [1, 2, 3]

// inerface æè¿°ä¸€ä¸ªå‡½æ•°çš„type
interface IPlus<T> {
    (a: T, b: T): T
}
function plus(a: number, b: number): number {
    return a + b;
}
function connect(a: string, b: string) {
    return a + b;
}
const a: IPlus<number> = plus
const b: IPlus<string> = connect
```

(4)TS+Reactç»„ä»¶åº“ï¼šç±»å‹åˆ«åå’Œç±»å‹æ–­è¨€

ç±»å‹åˆ«åï¼š

```typescript
// type aliases
type PlusType = (x: number, y: number) => number
function sum(x: number, y: number): number {
    return x + y
}
const sum2: PlusType = sum
// è”åˆç±»å‹ä¸‹çš„ç±»å‹åˆ«å
type NameResolver = () => string
type NameOrResolver = string | NameResolver
function getName(n: NameOrResolver): string {
    if (typeof n === 'string') {
        return n
    } else {
        return n()
    }
}
```

ç±»å‹æ–­è¨€ï¼š

```typescript
// type assertion
function getLength(input: string | number): number {
    const str = input as String
    if (str.length) {
        return str.length
    } else {
        const number = input as Number
        return number.toString().length
    }
}
// æ›´ç®€å•çš„å†™æ³•
// type assertion
function getLength(input: string | number): number {
    if ((<string>input).length) {
        return (<string>input).length
    } else {
        return input.toString().length
    }
}
```

(5)TS+Reactç»„ä»¶åº“ï¼šå£°æ˜æ–‡ä»¶ï¼Œå£°æ˜æ–‡ä»¶é€šå¸¸æ˜¯d.tsåç¼€çš„æ–‡ä»¶ï¼Œä¾‹å¦‚jQquery.d.ts

```bash
npm install --save @types/jquery
```

#### 2021å¹´01æœˆ26æ—¥ å‘¨äºŒ 05å‘¨

(1) WebRTCå­¦ä¹ ï¼šWebæœåŠ¡å™¨å·¥ä½œåŸç†

WebæœåŠ¡å™¨é€‰å‹ï¼š

- Nodejs
- Nginx
- Apache

ä¸¤ä¸ªV8å¼•æ“ï¼šChrome & Node

(2) TS+Reactæ‰“é€ ä¸ªäººç»„ä»¶åº“ï¼šReact ç®€ä»‹å’ŒåŸºç¡€çŸ¥è¯†ï¼Œprops&stateï¼Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼ŒçŠ¶æ€æå‡å’Œå•å‘æ•°æ®æµã€‚

(3) TS+Reactæ‰“é€ ä¸ªäººç»„ä»¶åº“ï¼šé…ç½® React å¼€å‘ç¯å¢ƒ

- å®˜æ–¹è„šæ‰‹æ¶å·¥å…·-create-react-app

```bash
npx create-react-app ts-with-react --template typescript
```

npx æ˜¯ä»€ä¹ˆï¼Ÿ

- é¿å…å®‰è£…å…¨å±€æ¨¡å—
- è°ƒç”¨é¡¹ç›®å†…éƒ¨å®‰è£…çš„æ¨¡å—

#### 2021å¹´01æœˆ27æ—¥ å‘¨ä¸‰ 05å‘¨

(1) WebRTCå­¦ä¹ ï¼šNodejsç¯å¢ƒæ­å»º

Nodejs çš„å®‰è£…æ–¹å¼ï¼š1.äºŒè¿›åˆ¶åº“å®‰è£…ï¼›2.æºç å®‰è£…ï¼›

äºŒè¿›åˆ¶åº“å®‰è£…æ­¥éª¤ï¼š

- apt/brew/yum install nodejs
- apt/brew/yum install npm

```bash
apt-cache search nodejs
apt install nodejs
apt install npm
```

æºç å®‰è£…æ­¥éª¤ï¼š

- ä¸‹è½½ Nodejs æºç 
- ç”Ÿæˆ Makefile
- `make -j 4 && sudo make install`

```bash
wget -c https://npm.taobao.org/mirrors/node/v14.15.4/node-v14.15.4.tar.gz
# è§£å‹
tar -zvxf node-v14.15.4.tar.gz
cd node-v14.15.4
ls configure
./configure --prefix=/usr/local/nodejs
```

ï¼ˆ2ï¼‰TS+React æ‰“é€ ç»„ä»¶åº“ï¼šç¬¬ä¸€ä¸ªç»„ä»¶ - tsä¸ºç»„ä»¶åŠ©åŠ›

```typescript
import React from 'react'

interface IHelloProps {
    message?: string;
}
// type React.FC<P = {}> = React.FunctionComponent<P>
const Hello: React.FC<IHelloProps> = (props) => {
    return <h2>{props.message}</h2>
}
Hello.defaultProps = {
    message: 'Hello World'
}
export default Hello
```

ï¼ˆ3ï¼‰TS+React æ‰“é€ ç»„ä»¶åº“ï¼šä»€ä¹ˆæ˜¯å’Œä¸ºä»€ä¹ˆè¦ç”¨ React Hookï¼ŒReact 16.8 å¸¦æ¥çš„æ–°ç‰¹æ€§ï¼Œå³å°†æ›¿ä»£ class ç»„ä»¶çš„å†™æ³•

æ²¡æœ‰ç ´åæ€§æ”¹åŠ¨ï¼š1.å®Œå…¨å¯é€‰ï¼›2.ç™¾åˆ†ç™¾å‘åå…¼å®¹ï¼›3.æ²¡æœ‰è®¡åˆ’ä» React ç§»é™¤ class;

ä¸ºä»€ä¹ˆç”¨ hookï¼šç»„ä»¶å¾ˆéš¾å¤ç”¨çŠ¶æ€é€»è¾‘ï¼› å¤æ‚ç»„ä»¶éš¾ä»¥ç†è§£ï¼Œå°¤å…¶æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼›React ç»„ä»¶ä¸€ç›´æ˜¯å‡½æ•°ï¼Œä½¿ç”¨ Hook å®Œå…¨æ‹¥æŠ±å‡½æ•°ï¼›

ï¼ˆ4ï¼‰TS+React æ‰“é€ ç»„ä»¶åº“ï¼šåœ¨å‡½æ•°ç»„ä»¶ä½¿ç”¨ state-useState Hook

Hook æ˜¯ä»€ä¹ˆï¼ŸHook æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥é’©ä½ React ç»„ä»¶çš„ç‰¹æ€§; ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨ useState Hook ? 

```tsx
import React, { useState } from 'react'
const LikeButton: React.FC = () => {
    const [like, setLike] = useState(0)
    const [on, setOn] = useState(true)
    return (
        <>
            <button onClick={() => { setLike(like + 1) }}>
                {like + 1} ğŸ‘
        </button>
            <button onClick={() => { setOn(!on) }}>
                {on ? 'ON' : 'OFF'} ğŸ‘
        </button>
        </>
    )
}
export default LikeButton
```

ï¼ˆ5ï¼‰TS+React æ‰“é€ ç»„ä»¶åº“ï¼šuseEffect ç¬¬ä¸€éƒ¨åˆ†-åˆå‡ºèŒ…åº

- æ— éœ€æ¸…é™¤çš„ Effectï¼Œä¾‹å¦‚å‘é€ç½‘ç»œè¯·æ±‚ï¼Œæ‰‹åŠ¨å˜æ›´DOMï¼Œè®°å½•æ—¥å¿—ï¼›
- éœ€è¦æ¸…é™¤çš„ Effect

useEffect åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œæ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šæ‰§è¡Œã€‚

ä»£ç æ—¶é—´ï¼šä½¿ç”¨ useEffect å®Œæˆ DOM çš„æ›´æ–°

```tsx
import React, { useState, useEffect } from 'react'
const LikeButton: React.FC = () => {
    const [like, setLike] = useState(0)
    const [on, setOn] = useState(true)
    useEffect(() => {
        document.title = `ç‚¹å‡»äº† ${like} æ¬¡`
    })
    return (
        <>
            <button onClick={() => { setLike(like + 1) }}>
                {like + 1} ğŸ‘
        </button>
            <button onClick={() => { setOn(!on) }}>
                {on ? 'ON' : 'OFF'} ğŸ‘
        </button>
        </>
    )
}
export default LikeButton
```

ï¼ˆ6ï¼‰TS+React æ‰“é€ ç»„ä»¶åº“ï¼šuseEffect ç¬¬äºŒéƒ¨åˆ†-æœ‰å§‹æœ‰ç»ˆ

- éœ€è¦æ¸…é™¤çš„Effect
- ä»£ç æ—¶é—´ï¼šä½¿ç”¨ useEffect å®Œæˆä¸€ä¸ªé¼ æ ‡è·Ÿè¸ªå™¨

```typescript
import React, { useState, useEffect } from 'react'

const MouseTracker: React.FC = () => {
    const [postions, setPositions] = useState({ x: 0, y: 0 })
    useEffect(() => {
        console.log('add effect', postions.x)
        const updateMouse = (e: MouseEvent) => {
            console.log('inner')
            setPositions({ x: e.clientX, y: e.clientY })
        }
        document.addEventListener('click', updateMouse)
        return () => {
            console.log('move effect', postions.x)
            document.removeEventListener('click', updateMouse)
        }
    })
    console.log('before render', postions.x)
    return (
        <p>X: {postions.x} ,Y:{postions.y} </p>
    )
}

export default MouseTracker
```

#### 2021å¹´01æœˆ28æ—¥ å‘¨å›› 05å‘¨

(1) WebRTCå­¦ä¹ ï¼šæœ€ç®€å•çš„ http æœåŠ¡

- require å¼•å…¥ http æ¨¡å—
- åˆ›å»º http æœåŠ¡
- æŒ‡å®šç›‘å¬ç«¯å£

```javascript
// åˆ›å»º http.js
"use strict";
var http = require("http");
var app = http
  .createServer(function (req, res) {
    res.writeHead(200, { "Content-Type": "text/plain" });
    res.end("Hello World\n");
  })
  .listen(8080, "127.0.0.1");
```

```bash
# è¿è¡Œ http.js çš„ä¸‰ç§æ–¹å¼
# æ–¹å¼ä¸€ï¼Œæ–­å¼€æœåŠ¡åï¼Œæ‰€æœ‰æœåŠ¡ç»ˆæ­¢
node http.js
# æ–¹å¼äºŒï¼Œä¸€ç›´ä¿æŒï¼Œä½†æ—¥å¿—è¾“å‡ºæœ‰é—®é¢˜
nohub node http.js & 
# æ–¹å¼ä¸‰ï¼Œé€šè¿‡ forever,åœ¨åå°å¯åŠ¨æˆ–åœæ­¢ç¨‹åº
forever start http.js
forever stop http.js
```

```bash
npm install forever -g 
```

#### 2021å¹´01æœˆ29æ—¥ å‘¨äº” 05å‘¨

(1) WebRTCå­¦ä¹ ï¼šåˆ›å»º https æœåŠ¡

ä¸ºä»€ä¹ˆè¦ä½¿ç”¨HTTSæœåŠ¡ï¼Ÿ ä¸ªäººéšç§åŠå®‰å…¨é—®é¢˜ï¼›https æ˜¯æœªæ¥çš„è¶‹åŠ¿ï¼›HTTPS = HTTP + TLS/SSL

Nodejs æ­å»º HTTPS æœåŠ¡ï¼Ÿ ç”Ÿæˆ HTTPS è¯ä¹¦ï¼›å¼•å…¥ HTTPS æ¨¡å—ï¼›æŒ‡å®šè¯ä¹¦ä½ç½®ï¼Œå¹¶åˆ›å»º HTTPS æœåŠ¡

```javascript
"use strict";
var https = require("https");
var fs = require("fs");
var options = {
  // è¯ä¹¦çš„åœ°å€
  key: fs.readFileSync("./....xxx.key"),
  cert: fs.readFileSync("./....xxx.pem"),
};
var app = https
  .createServer(options, function (req, res) {
    res.writeHead(200, { "Content-Type": "text/plain" });
    res.end("HTTPS:Hello World!\n");
  })
  .listen(443, "0,0,0,0");
```

ï¼ˆ2ï¼‰TS+React æ‰“é€ ç»„ä»¶åº“ï¼šuseEffect ç¬¬ä¸‰éƒ¨åˆ†-æ§åˆ¶è¿è¡Œ

```typescript
import React, { useState, useEffect } from 'react'
const LikeButton: React.FC = () => {
    const [like, setLike] = useState(0)
    const [on, setOn] = useState(true)
    useEffect(() => {
        console.log('document title effect is runnning')
        document.title = `ç‚¹å‡»äº† ${like} æ¬¡`
    }, [like, on])
    return (
        <>
            <button onClick={() => { setLike(like + 1) }}>
                {like + 1} ğŸ‘
        </button>
            <button onClick={() => { setOn(!on) }}>
                {on ? 'ON' : 'OFF'} ğŸ‘
        </button>
        </>
    )
}
export default LikeButton
```

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šè‡ªå®šä¹‰ Hook-é‡æ„ MouseTrackerï¼Œå°†ç»„ä»¶é€»è¾‘æŠ½å–åˆ°å¯é‡ç”¨çš„å‡½æ•°ä¸­; è‡ªå®šä¹‰ hooks å‡½æ•°å¿…é¡»ä½¿ç”¨ `use` å¼€å¤´

```tsx
import React, { useState, useEffect } from 'react'
const useMousePositon = () => {
    const [positions, setPositions] = useState({ x: 0, y: 0 })
    useEffect(() => {
        console.log('add effect', positions.x)
        const updateMouse = (e: MouseEvent) => {
            setPositions({ x: e.clientX, y: e.clientY })
        }
        document.addEventListener('mousemove', updateMouse)
        return () => {
            console.log('move effect', positions.x)
            document.removeEventListener('mousemove', updateMouse)
        }
    }, [])
    return positions
}
export default useMousePositon
```

(4)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šè‡ªå®šä¹‰ Hook ç¬¬äºŒéƒ¨åˆ†-HOCçš„åŠ£åŠ¿

- é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚

#### 2021å¹´01æœˆ31æ—¥ å‘¨æ—¥ 05å‘¨

(1)WebRTCå­¦ä¹ ï¼šçœŸæ­£çš„WebæœåŠ¡å™¨ï¼Œæ—¢æ”¯æŒhttpåˆæ”¯æŒhttps

- å¼•å…¥expressæ¨¡å—
- å¼•å…¥server-indexæ¨¡å—
- æŒ‡å®šå‘å¸ƒç›®å½•

```bash
npm i express@4.16.4 serve-index@1.9.1 --save
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šè‡ªå®šä¹‰hookç¬¬ä¸‰éƒ¨åˆ†-æ­£ç¡®çš„æ–¹å¼å®Œæˆ URLLoader

```typescript
import { useState, useEffect } from 'react'
import axios from 'axios'

const useURLLoader = (url: string, deps: any[] = []) => {
    const [data, setData] = useState<any>(null)
    const [loading, setLoading] = useState(false)
    useEffect(() => {
        setLoading(true)
        axios.get(url).then(result => {
            setData(result.data)
            setLoading(false)
        })
    }, deps)
    return [data, loading]
}
export default useURLLoader
```

 å¯ä»¥å°†é€»è¾‘ä¸Šé‡å¤çš„ä»£ç æå–åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œåƒè°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¸€æ ·è°ƒç”¨ hooksï¼Œä½¿ç”¨hooksè¿”å›ç»“æœï¼Œåšæˆ‘ä»¬æƒ³åšçš„ã€‚

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šuseRef - stateé‡åˆ°çš„éš¾é¢˜

åœ¨ä»»æ„ä¸€æ¬¡æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œprops å’Œ state å§‹ç»ˆæ˜¯ä¿æŒä¸å˜çš„ï¼Œå¦‚æœ props å’Œ state åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆä½¿ç”¨åˆ°å®ƒä»¬çš„ä»»ä½•å€¼ï¼Œä¹Ÿéƒ½æ˜¯ç‹¬ç«‹çš„ã€‚useRef æ˜¯è®©ä¸åŒçš„æ¸²æŸ“ä¹‹é—´äº§ç”Ÿè”ç³»çš„ hook å‡½æ•°ã€‚

(4)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šuseRef - å¤šæ¬¡æ¸²æŸ“ä¹‹é—´çš„çº½å¸¦

ä¿®æ”¹ ref çš„å€¼ï¼Œç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼›

#### 2021å¹´02æœˆ01æ—¥ å‘¨ä¸€ 06å‘¨

(1)WebRTCå­¦ä¹ ï¼šJavaScript è°ƒè¯•æ–¹æ³•

```javascript
// google demo
https://appr.tc
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šuseContext-è§£å†³å¤šå±‚ä¼ é€’å±æ€§çš„çµä¸¹å¦™è¯

context æä¾›äº†ä¸€ç§åœ¨ç»„ä»¶é—´å…±äº«å±æ€§çš„æ–¹å¼ï¼Œè€Œä¸å¿…é€šè¿‡ç»„ä»¶æ ‘çš„å½¢å¼ï¼Œé€šè¿‡æ¯ä¸ªå±‚çº§æ˜¾ç¤ºçš„ä¼ é€’ propsã€‚context çš„è®¾è®¡æ˜¯ä¸ºäº†å…±äº«å¯¹äºç»„ä»¶æ ‘è€Œè¨€æ˜¯å…¨å±€çš„æ•°æ®ã€‚

```typescript
// App.tsx
export const ThemeContext = React.createContext(themes.light)
<ThemeContext.Provider value={themes.dark}></ThemeContext.Provider>

// LikeButton.tsx
import React, { useState, useEffect, useRef, useContext } from 'react'
const theme = useContext(ThemeContext)
    console.log(theme)
    const style = {
        background: theme.background,
        color: theme.color
    }
```

#### 2021å¹´02æœˆ03æ—¥ å‘¨ä¸‰ 06å‘¨

(1) WebRTCå­¦ä¹ ï¼šå˜é‡ä¸åŸºæœ¬è¿ç®—

åŸºç¡€çŸ¥è¯†ï¼šå˜é‡ä¸ç±»å‹ã€forå¾ªç¯ã€åŸºæœ¬è¿ç®—ã€å‡½æ•°ã€if/elseã€æ—¥å¿—æ‰“å°

**å˜é‡ä¸ç±»å‹**

|          | javascript          | Cè¯­è¨€                    |
| -------- | ------------------- | ------------------------ |
| å®šä¹‰å˜é‡ | `var a;` ; `let a;` | `int a;`                 |
| å¸ƒå°”     | `true` or`false`    | `1` or `0`               |
| å­—ç¬¦ä¸²   | `'hello world'`     | `char str="hello world"` |
| æ•°ç»„     | `[1,5.1,'  hw']`    | `Int arr[]= {1,5,6}`     |
| ç©º       | `null`,`undefined`  | `NULL`,`0`               |

**åŸºæœ¬è¿ç®—**

|          | javascript      | Cè¯­è¨€           |
| -------- | --------------- | --------------- |
| ç®—æ•°è¿ç®— | `+, -, *, / ,%` | `+, -, *, / ,%` |
| æ¯”è¾ƒè¿ç®— | `>,<,!=,==,===` | `>,<,!=,==`     |
| é€»è¾‘è¿ç®— | `&&,||,!`       | `&&,||,!`       |

#### 2021å¹´02æœˆ04æ—¥ å‘¨å›› 06å‘¨

(1) WebRTCå­¦ä¹ ï¼šåˆ¤æ–­å¾ªç¯ä¸å‡½æ•°

|                  | javascript                               | Cè¯­è¨€              |
| ---------------- | ---------------------------------------- | ------------------ |
| `if ... else`    | `if (){} else if(){} else{}`             | åŒ javascript ä¸€æ · |
| `switch ...case` | `switch case`                            | åŒ javascript ä¸€æ · |
| `for`            | `for(...){}`                             | åŒ javascript ä¸€æ · |
| `for ...in`      | `for(var i in arr){console.log(arr[i])}` | æ—                  |
| `while`          | `while(){}`                              | åŒ javascript ä¸€æ · |

**å‡½æ•°**

|          | javascript                          | Cè¯­è¨€                          |
| -------- | ----------------------------------- | ------------------------------ |
| å‡½æ•°å®šä¹‰ | `function func(...){...return ret}` | `int func(...){...return ret}` |
| ç®­å¤´å‡½æ•° | `()=>{...}`                         | æ—                              |

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šhook è§„åˆ™å’Œå…¶ä»– hook

- åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ hook
- åªåœ¨Reactå‡½æ•°ä¸­è°ƒç”¨ hook

å…¶ä»– hook : useReducer,useCallback

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šç»„ä»¶åº“èµ·èˆª-éœ€æ±‚åˆ†æ

å®Œæˆä¸€ä¸ªç»„ä»¶åº“éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Ÿ

- ä»£ç ç»“æ„

- æ ·å¼è§£å†³æ–¹æ¡ˆ

- ç»„ä»¶éœ€æ±‚åˆ†æå’Œç¼–ç 

- ç»„ä»¶æµ‹è¯•ç”¨ä¾‹åˆ†æå’Œç¼–ç 

- ä»£ç æ‰“åŒ…è¾“å‡ºå’Œå‘å¸ƒ

- CI/CDï¼Œæ–‡æ¡£ç”Ÿæˆç­‰ç­‰

åˆå§‹åŒ–ç»„ä»¶é¡¹ç›®

  ```bash
npx create-react-app jerrychaneui --template typescript
  ```

####  2021å¹´02æœˆ05æ—¥ å‘¨äº” 06å‘¨

 (1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ–‡ä»¶ç»“æ„å’Œä»£ç è§„èŒƒ

ä¸€ç§æ˜¯æŒ‰ç…§åŠŸèƒ½å’Œè·¯ç”±ï¼›ä¸€ç§æ˜¯æŒ‰ç…§æ–‡ä»¶ç±»å‹ï¼›å°½å¯èƒ½ç®€å•ï¼Œæœ¬é¡¹ç›®ä½¿ç”¨çš„æ–‡ä»¶ç»“æ„å¦‚ä¸‹

```
jerrychaneui/
	README.md
	node_modules
	package.json
	tsconfig.json
	src/
		components/
			Button/
				button.tsx
				button.test.tsx
				style.scss
    styles/
    	...
    index.tsx
```

ä»£ç è§„èŒƒ: 2.0.4 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œä¸éœ€è¦ç‰¹æ®Šé…ç½®ï¼Œé»˜è®¤æ”¯æŒ `typescript` è¯­æ³•æ£€æŸ¥ï¼Œéœ€å®‰è£… `eslint`æ’ä»¶ã€‚

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ ·å¼è§£å†³æ–¹æ¡ˆåˆ†æ

- Inline CSS(æ€§èƒ½æœ€å¥½)

```jsx
const divStyle = {
  color:'blue',
  backgroundImg:'url('+imgUrl+')',
}
function HelloComponent(){
  return <div style={style}>Hello</div>
}
```

- CSS in JS

- Style Component

- Sass / Less(æœ¬é¡¹ç›®æ¨è)

æ ·å¼æ–‡ä»¶ç³»ç»Ÿç»“æ„ï¼š

```
styles/
	_variables.scss(å„ç§å˜é‡ä»¥åŠå¯é…ç½®è®¾ç½®)
	_mixins.scss(å…¨å±€ mixins)
	_functions.scss(å…¨å±€ functions)
components/
	Button/
		style.scss(å•ç»„ç»‡æ–‡ä»¶çš„æ ·å¼)
		...
```

(3) WebRTCå­¦ä¹ ï¼šWebRTCè·å–éŸ³è§†é¢‘è®¾å¤‡

API: enumerateDevices()

**åŸºæœ¬æ ¼å¼**

```javascript
var ePromise = navigator.mediaDevices.enumerateDevices();
```

è¿”å›å€¼æ˜¯ä¸€ä¸ª Promise

**MediaDevicesInfo**

MediaDevicesInfo ä¸­å­˜æ”¾äº†è®¸å¤šéŸ³è§†é¢‘ç›¸å…³çš„ä¿¡æ¯ï¼›

| å±æ€§     | è¯´æ˜                                      |
| -------- | ----------------------------------------- |
| deviceID | è®¾å¤‡ID                                    |
| label    | è®¾å¤‡çš„åå­—                                |
| kind     | è®¾å¤‡çš„ç§ç±»                                |
| groupID  | ä¸¤ä¸ªè®¾å¤‡GroupIDç›¸åŒï¼Œè¯´æ˜æ˜¯åŒä¸€ä¸ªç‰©ç†è®¾å¤‡ |

**JavaScript ä¸­çš„ Promise**

(4) WebRTCå­¦ä¹ ï¼šåœ¨é¡µé¢ä¸­æ˜¾ç¤ºè·å–åˆ°çš„è®¾å¤‡

```javascript
// js/client.js
"use strict";
var audioSource = document.querySelector("select#audioSource");
var audioOutput = document.querySelector("select#audioOutput");
var videoSource = document.querySelector("select#videoSource");

if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {
  console.log("enumerateDevices is not supported!");
} else {
  navigator.mediaDevices.enumerateDevices().then(gotDevice).catch(handleError);
}

function gotDevice(deviceInfos) {
  deviceInfos.forEach((deviceInfo) => {
    var option = document.createElement("option");
    option.text = deviceInfo.label;
    option.value = deviceInfo.deviceId;
    if (deviceInfo.kind === "audioinput") {
      audioSource.appendChild(option);
    } else if (deviceInfo.kind === "audiooutput") {
      audioOutput.appendChild(option);
    } else if (deviceInfo.kind === "videoinput") {
      videoSource.appendChild(option);
    }
  });
}

function handleError(error) {
  console.log(error.name + " : " + error.message);
}
```

#### 2021å¹´02æœˆ07æ—¥ å‘¨æ—¥ 06å‘¨

(1) WebRTCå­¦ä¹ ï¼šWebRTC éŸ³è§†é¢‘æ•°æ®é‡‡é›†

åŸºæœ¬æ ¼å¼ï¼š

```javascript
var promise = navigator.mediaDevices.getUserMedia(constraints)
```

MediaStreamConstrains:

```javascript
dictionary MediaStreamConstraints {
  (boolean or MediaTrackConstraints) video = false;
  (boolean or MediaTrackConstraints) audio = false;
}
```

```javascript
// js/client
"use strict";
var videoplay = document.querySelector("video#player");

function gotMediaStream(stream) {
  videoplay.srcObject = stream;
}

function handleError(error) {
  console.log("getUserMedia error:", error);
}

if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
  console.log("getUserMedia is not supported");
} else {
  var constraints = {
    video: true,
    audeo: true,
  };
  navigator.mediaDevices
    .getUserMedia(constraints)
    .then(gotMediaStream)
    .catch(handleError);
}
```

(2) WebRTCå­¦ä¹ ï¼šæµè§ˆå™¨é€‚é…æ–¹æ³• WebRTC_API é€‚é…

getUserMedia é€‚é…ï¼š

- W3C è§„èŒƒä¸­ï¼šgetUserMedia
- Chrome: webkitGetUserMedia
- Firefox: mozGetUserMedia

è‡ªå·±å®ç°ï¼š

```javascript
var getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia|| navigator.mozGetUserMedia;
```

ä½¿ç”¨ Google å¼€æºåº“ adapter.js,é€‚é…ä¸åŒæµè§ˆå™¨çš„ API

```
https://webrtc.github.io/adapter/adapter-latest.js
```

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ è‡ªå·±çš„è‰²å½©ä½“ç³»

åˆ›å»ºè‡ªå·±ç»„ä»¶åº“çš„è‰²å½©ä½“ç³»

- ç³»ç»Ÿè‰²æ¿ - åŸºç¡€è‰²æ¿ + ä¸­æ€§è‰²æ¿
- äº§å“è‰²æ¿ - å“ç‰Œè‰² + åŠŸèƒ½è‰²æ¿

Bootstrap çš„è‰²å½©ä½“ç³»

- #0275d8 (è“è‰²)ã€#5cb85c(ç»¿è‰²)ã€#5bc0de(æµ…è“)ã€#f0ad4e(æ©™è‰²)ã€#d9534f(çº¢è‰²)ã€#292b2c(é»‘è‰²)ã€#f7f7f7(ç™½è‰²)

æˆ‘ä»¬ç»„ä»¶åº“çš„è‰²å½©ä½“ç³»

- #0d6efd (è“è‰²)ã€#6c757d(é»‘è‰²)ã€#52c41a(ç»¿è‰²)ã€#fadb14(æ©™è‰²)ã€#dc3545(çº¢è‰²)ã€#17a2b8(é»‘è‰²)

```shell
npm i node-sass --save
```

(4)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ å­—ä½“å˜é‡è§£å†³æ–¹æ¡ˆ

ç»„ä»¶åº“æ ·å¼å˜é‡åˆ†ç±»ï¼š1-åŸºç¡€è‰²å½©ç³»ç»Ÿï¼›2-å­—ä½“ç³»ç»Ÿï¼›3-è¡¨å•ï¼›4-æŒ‰é’®ï¼›5-è¾¹æ¡†å’Œé˜´å½±ï¼›6-å¯é…ç½®å¼€å…³

#### 2021å¹´02æœˆ08æ—¥ å‘¨ä¸€ 07å‘¨

(1) WebRTCå­¦ä¹ ï¼šå®‰å…¨ç®¡ç†-è·å–éŸ³è§†é¢‘è®¾å¤‡çš„è®¿é—®æƒé™

```javascript
"use strict";
var videoplay = document.querySelector("video#player");
let audioSource = document.querySelector("select#audioSource");
let audioOutput = document.querySelector("select#audioOutput");
let videoSource = document.querySelector("select#videoSource");

function gotDevices(deviceInfos) {
  deviceInfos.forEach((deviceInfo) => {
    let option = document.createElement("option");
    option.text = deviceInfo.label;
    option.value = deviceInfo.deviceId;
    if (deviceInfo.kind === "audioinput") {
      audioSource.appendChild(option);
    } else if (deviceInfo.kind === "audiooutput") {
      audioOutput.appendChild(option);
    } else if (deviceInfo.kind === "videoinput") {
      videoSource.appendChild(option);
    }
  });
}

function gotMediaStream(stream) {
  videoplay.srcObject = stream;
  return navigator.mediaDevices.enumerateDevices();
}

function handleError(error) {
  console.log("getUserMedia error:", error);
}

if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
  console.log("getUserMedia is not supported");
} else {
  var constraints = {
    video: true,
    audio: true,
  };
  navigator.mediaDevices
    .getUserMedia(constraints)
    .then(gotMediaStream)
    .then(gotDevices)
    .catch(handleError);
}
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šåˆæ¬¡äº®ç›¸-æ·»åŠ normalize.css

```
https://github.com/necolas/normalize.css
```

#### 2021å¹´02æœˆ09æ—¥ å‘¨äºŒ 07å‘¨

(1) WebRTCå­¦ä¹ ï¼šè§†é¢‘å‚æ•°è°ƒæ•´-è§†é¢‘çº¦æŸï¼ŒWebRTC éŸ³è§†é¢‘é‡‡é›†çº¦æŸ

- width / height / aspectRatio(æ¯”ä¾‹) / frameRate(å¸§ç‡) 
- facingMode(user:å‰ç½®æ‘„åƒå¤´ï¼›environment:åç½®æ‘„åƒå¤´ï¼›left:å‰ç½®å·¦æ‘„åƒå¤´ï¼›right:å‰ç½®å³æ‘„åƒå¤´)
- resizeMode:ç”»é¢æ˜¯å¦éœ€è¦è£å‰ª

#### 2021å¹´02æœˆ10æ—¥ å‘¨ä¸‰ 07å‘¨

(1)WebRTCå­¦ä¹ ï¼šè§†é¢‘å‚æ•°è°ƒæ•´-è§†é¢‘çº¦æŸï¼ŒWebRTC éŸ³è§†é¢‘é‡‡é›†çº¦æŸ

```javascript
var constraints = {
    video: {
      width: {
        min:480,
        max:640
      },
      height:  {
        min:240,
        max:320
      },
      frameRate:  {
        min:15,
        max:30
      },
      facingMode: "environment",
    },
    audio: false,
  };
```

(2)WebRTCå­¦ä¹ ï¼šéŸ³é¢‘å‚æ•°è°ƒæ•´-éŸ³é¢‘çº¦æŸ

- volume(éŸ³é‡):0-1.0
- sampleRate(é‡‡æ ·ç‡)ï¼š48000,32000,8000
- sampleSize(é‡‡æ ·å¤§å°)ï¼š16ä½å³2å­—èŠ‚
- echoCancellation(å›éŸ³)ï¼štrue || fasle
- autoGainControl(è‡ªåŠ¨å¢ç›Š): true || fasle
- noiseSuppression(é™å™ª): true || fasle
- latency(å»¶è¿Ÿå¤§å°):200msä»¥å†…æ˜¯æœ€å¥½çš„
- channelCount(å•åŒå£°é“)
- deviceIDã€groupID

#### 2021å¹´02æœˆ12æ—¥ å‘¨äº” 07å‘¨

do nothing

#### 2021å¹´02æœˆ14æ—¥ å‘¨æ—¥ 07å‘¨

do nothing

#### 2021å¹´02æœˆ15æ—¥ å‘¨ä¸€ 08å‘¨

(1)WebRTCå­¦ä¹ ï¼šè§†é¢‘ç‰¹æ•ˆ

- CSS filter,-webkit-filter/filter
- å¦‚ä½•å°† video ä¸ filter å…³è”
- OpenGL/Metal/ ...

æ”¯æŒçš„ç‰¹æ•ˆç±»å‹ï¼š

| ç‰¹æ•ˆ       | è¯´æ˜     | ç‰¹æ•ˆ        | è¯´æ˜   |
| ---------- | -------- | ----------- | ------ |
| grayscale  | ç°åº¦     | opacity     | é€æ˜åº¦ |
| sepia      | è¤è‰²     | brightness  | äº®åº¦   |
| saturate   | é¥±å’Œåº¦   | contrast    | å¯¹æ¯”åº¦ |
| hue-rotate | è‰²ç›¸æ—‹è½¬ | blur        | æ¨¡ç³Š   |
| invert     | åè‰²     | drop-shadow | é˜´å½±   |

#### 2021å¹´02æœˆ16æ—¥ å‘¨äºŒ 08å‘¨

do nothing

#### 2021å¹´02æœˆ17æ—¥ å‘¨ä¸‰ 08å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ  normalize.css

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šButton ç»„ä»¶éœ€æ±‚åˆ†æ

- ä¸åŒçš„ Button Type: Primary, Default, Danger, Link Button;
- ä¸åŒçš„ Button Size: Normal, Small, Large;
- Disable çš„çŠ¶æ€ï¼šDisabled(æ™®é€šçš„ä¸å¯ç”¨), Link Button(é“¾æ¥çš„ä¸å¯ç”¨);

```jsx
<Button
  size="lg"
  type="primary"
  disabled
  href="" ?
  className="" ?
  autoFocus="" ?
  ...
  >
  JerryChane Button
</Button>
```

(3)WebRTCå­¦ä¹ ï¼šä»è§†é¢‘ä¸­è·å–å›¾ç‰‡

1ã€æ‹¿åˆ°éŸ³è§†é¢‘æµ
2ã€ç‚¹å‡»buttonæ‹¿åˆ°è¯¥å¸§
3ã€ä½¿ç”¨canvasè¾“å‡ºæˆå›¾ç‰‡

(4)WebRTCå­¦ä¹ ï¼šåªé‡‡é›†éŸ³é¢‘æ•°æ®

#### 2021å¹´02æœˆ18æ—¥ å‘¨å›› 08å‘¨

(1) WebRTCå­¦ä¹ ï¼šMediaStreamAPIåŠè·å–è§†é¢‘çº¦æŸ

MediaStreamAPI

- MediaStream.addTrack()
- MediaStream.removeTrack()
- MediaStream.getVedeoTracks()
- MediaStream.getAudioTracks()

MediaStream äº‹ä»¶API

- MediaStream.onaddtrack
- MediaStream.onremovetrack
- MediaStream.onended

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šButton ç»„ä»¶ç¼–ç ç¬¬ä¸€éƒ¨åˆ†

```bash
npm install classnames --save
npm install @types/classnames --save
```

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ  Button åŸºæœ¬æ ·å¼

#### 2021å¹´02æœˆ19æ—¥ å‘¨äº” 08å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šå‡çº§ Button ç»„ä»¶æ ·å¼

```scss
/*_mixin.scss*/
@mixin button-size($padding-y, $padding-x, $font-size, $border-radius) {
    padding: $padding-y $padding-x;
    font-size: $font-size;
    border-radius: $border-radius;
}

@mixin button-style($background,
    $border,
    $color,
    $hover-background:lighten($background, 7.5%),
    $hover-border:lighten($border, 10%),
    $hover-color: $color) {
    color: $color;
    background: $background;
    border-color: $border;

    &:hover {
        color: $hover-color;
        background: $hover-background;
        border-color: $hover-border;
    }

    &:focus,
    &.focus {
        color: $hover-color;
        background: $hover-background;
        border-color: $hover-border;
    }

    &:disabled,
    &.disabled {
        color: $color;
        background: $background;
        border-color: $border;
    }
}
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šç²¾ç›Šæ±‚ç²¾ - Buton ç»„ä»¶ç¼–ç ç¬¬äºŒéƒ¨åˆ†

```tsx
// è·å–æŒ‰é’®ä¸Šçš„å±æ€§ï¼Œå¹¶åˆå¹¶
type NativeButtonProps = BaseButtonProps & React.ButtonHTMLAttributes<HTMLElement>
// è·å–é“¾æ¥ä¸Šçš„å±æ€§ï¼Œå¹¶åˆå¹¶
type AnchorButtonProps = BaseButtonProps & React.AnchorHTMLAttributes<HTMLElement>
// åˆå¹¶æ‰€æœ‰å±æ€§ï¼Œå¹¶å¯¼å‡º
export type ButtonProps = Partial<NativeButtonProps & AnchorButtonProps>
```

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šä¸ºä»€ä¹ˆè¦æœ‰æµ‹è¯•

å›½å†…äº’è”ç½‘æµ‹è¯•ç°çŠ¶

- é‡è§†ç¨‹åº¦ä¸¥é‡ä¸è¶³ ã€ æ²¡æœ‰æ—¶é—´ã€ä¸ä¼šå†™æµ‹è¯•

æµ‹è¯•çš„é‡è¦æ€§

- é«˜è´¨é‡çš„ä»£ç ã€æ›´æ—©çš„å‘ç° Bug,å‡å°‘æˆæœ¬ã€è®©é‡æ„å’Œå‡çº§å˜å¾—æ›´åŠ å®¹æ˜“å’Œå¯é ã€è®©å¼€å‘æµç¨‹æ›´åŠ æ•æ·

æµ‹è¯•é‡‘å­—å¡”

- ä»ä¸‹åˆ°ä¸Šï¼šUnit => Service => UI

React ç»„ä»¶ç‰¹åˆ«é€‚åˆå†™å•å…ƒæµ‹è¯•

- Component ç»„ä»¶åŒ–ã€ Function å‡½æ•° ã€å•å‘æ•°æ®æµ

#### 2021å¹´02æœˆ20æ—¥ å‘¨å…­ 08å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šé€šç”¨æµ‹è¯•æ¡†æ¶ Jest å‡ºåœº

creat-react-app è„šæ‰‹æ¶å†…ç½®äº† jest ï¼Œå¯ä»¥ä½¿ç”¨ `npx jest aaa.js --watch`,æ¥æµ‹è¯•

```javascript
test("test common matcher", () => {
  expect(2 + 2).toBe(4);
  expect(2 + 2).not.toBe(5);
});

test("test to be true or false", () => {
  expect(1).toBeTruthy();
  expect(0).toBeFalsy();
});

test("test number", () => {
  expect(4).toBeGreaterThan(3);
  expect(2).toBeLessThan(3);
});
// toBe è¡¨ç¤ºå®Œå…¨ç›¸åŒï¼Œç›¸å½“äº === toEqual ç›¸å½“äº ==
test("test object", () => {
  // expect({ name: "jerrychane" }).toBe({ name: "jerrychane" });
  expect({ name: "jerrychane" }).toEqual({ name: "jerrychane" });
});
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šReact æµ‹è¯•å·¥å…· - react-testing-library

```tsx
// jerrychaneui/src/components/Button/button.test.tsx
import React from 'react'
import { render } from '@testing-library/react'
import Button from './button'

test('our first react test case', () => {
    const wrapper = render(<Button>Nice</Button>)
    const element = wrapper.queryByText('Nice')
    expect(element).toBeTruthy()
})
```

è¿è¡Œæµ‹è¯•æ–‡ä»¶ï¼š `npm  run test`

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ Button æµ‹è¯•ä»£ç  ç¬¬ä¸€éƒ¨åˆ†

```tsx
// jerrychaneui/src/components/Button/button.test.tsx
describe('test Button component', () => {
    it('should render the correct  default button', () => {
        const wrapper = render(<Button>Nice</Button>)
        const element = wrapper.getByText('Nice')
        expect(element).toBeInTheDocument()
        expect(element.tagName).toEqual('BUTTON')
        expect(element).toHaveClass('btn btn-default')
    })
    it('should render the correct component based on different props', () => {

    })
    it('should render a link when btnType equals link and href is provided', () => {

    })
    it('should render disabled button when disabled set to true', () => {

    })
})
```

(4)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ Button æµ‹è¯•ä»£ç  ç¬¬äºŒéƒ¨åˆ†

```tsx
// jerrychaneui/src/components/Button/button.test.tsx
import React from 'react'
import { render, fireEvent } from '@testing-library/react'
import Button, { ButtonProps, ButtonSize, ButtonType } from './button'

const defaultProps = {
    onClick: jest.fn()
}

const testProps: ButtonProps = {
    btnType: ButtonType.Primary,
    size: ButtonSize.Large,
    className: 'klass'
}
const disabledProps: ButtonProps = {
    disabled: true,
    onClick: jest.fn()
}

describe('test Button component', () => {
    it('should render the correct  default button', () => {
        const wrapper = render(<Button {...defaultProps}>Nice</Button>)
        const element = wrapper.getByText('Nice') as HTMLButtonElement
        expect(element).toBeInTheDocument()
        expect(element.tagName).toEqual('BUTTON')
        expect(element).toHaveClass('btn btn-default')
        expect(element.disabled).toBeFalsy()
        fireEvent.click(element)
        expect(defaultProps.onClick).toBeCalled()
    })
    it('should render the correct component based on different props', () => {
        const wrapper = render(<Button {...testProps}>Nice</Button>)
        const element = wrapper.getByText('Nice')
        expect(element).toBeInTheDocument()
        expect(element).toHaveClass('btn-primary btn-lg klass')
    })
    it('should render a link when btnType equals link and href is provided', () => {
        const wrapper = render(<Button btnType={ButtonType.Link} href="https://jerrychane.com" >Link</Button>)
        const element = wrapper.getByText('Link')
        expect(element).toBeInTheDocument()
        expect(element.tagName).toEqual('A')
        expect(element).toHaveClass('btn btn-link')
    })
    it('should render disabled button when disabled set to true', () => {
        const wrapper = render(<Button {...disabledProps}>Nice</Button>)
        const element = wrapper.getByText('Nice') as HTMLButtonElement
        expect(element).toBeInTheDocument()
        expect(element.disabled).toBeTruthy()
        fireEvent.click(element)
        expect(disabledProps.onClick).not.toHaveBeenCalled()
    })
})
```

#### 2021å¹´02æœˆ21æ—¥ å‘¨æ—¥ 08å‘¨

do nothing

#### 2021å¹´02æœˆ22æ—¥ å‘¨ä¸€ 09å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šMenu ç»„ä»¶éœ€æ±‚åˆ†æ

ä»¥ä¸‹å‡ä¸ºä¼ªä»£ç ï¼š

```js
// ä¸€ä¸ªä¸é‚£ä¹ˆå®Œç¾çš„è§£å†³æ–¹æ¡ˆ
const items = [
  {disabled:false,element:(<a>title</a>)},
  {disabled:true,element:'cool link'}
]
<Menu defaultIndex={0} items={items} onSelect={} mode="vertical"></Menu>
```

```js
// æ›´åŠ è¯­ä¹‰åŒ–ï¼Œæ›´åƒ HTML çš„è§£å†³æ–¹æ¡ˆ
<Menu defaultIndex={0} onSelect={} mode="vertical">
  <Menu.item>title one</Menu.item>
  <Menu.item disabled>disabled link</Menu.item>
 <Menu.item><a href="https://www.google.com">Google!</a></Menu.item>
</Menu>
// å±æ€§åˆ†æ
interface MenuProps {
  activeIndex:number;
  mode: string;// æŸç§å¸¸é‡
  onSelect:(selectedIndex:number)=> voild
  className:string;
}
interface MenuItemProps {
  index:number;
  disabled: boolean;
  className:string;
}
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šåŸºç¡€æ¶æ„ - Menuç»„ä»¶ç¼–ç ç¬¬ä¸€éƒ¨åˆ†

```tsx
import React from 'react'
import classNames from 'classnames'

type MenuMode = 'horizontal' | 'vertical'
export interface MenuProps {
    defaultIndex?: number;
    className?: string;
    mode?: MenuMode;
    style?: React.CSSProperties;
    onSelect?: (selectedIndex: number) => void
}

const Menu: React.FC<MenuProps> = (props) => {
    const { defaultIndex, className, mode, style, children } = props
    const classes = classNames('jerrychane-menu', className, {
        'menu-vertical': mode === 'vertical'
    })
    return (
        <ul className={classes} style={style}>
            {children}
        </ul>
    )
}

Menu.defaultProps = {
    defaultIndex: 0,
    mode: 'horizontal'
}

export default Menu;
```

(3)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šéœ€æ±‚å‡çº§ - Menu ç»„ä»¶ç¼–ç ç¬¬äºŒéƒ¨åˆ†

#### 2021å¹´02æœˆ23æ—¥ å‘¨äºŒ  09å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ  Menu æ ·å¼

```html
https://css-tricks.com/snippets/css/a-guide-to-flexbox/
```

#### 2021å¹´02æœˆ24æ—¥ å‘¨ä¸‰  09å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæµ‹è¯•é©±åŠ¨-Menu æµ‹è¯•æ·»åŠ 

```tsx
//jerrychaneui/src/components/Menu/menu.test.tsx
import React from 'react'
import { cleanup, fireEvent, render, RenderResult } from '@testing-library/react'
import Menu, { MenuProps } from './menu'
import MenuItem from './menuItem'

const testProps: MenuProps = {
    defaultIndex: 0,
    onSelect: jest.fn(),
    className: 'test'
}

const testVerticalProps: MenuProps = {
    defaultIndex: 0,
    mode: 'vertical'
}

const generateMenu = (props: MenuProps) => {
    return (
        <Menu {...props}>
            <MenuItem index={0}>active</MenuItem>
            <MenuItem disabled index={1}>disabled</MenuItem>
            <MenuItem index={2}>xyz</MenuItem>
        </Menu>
    )
}
let wrapper: RenderResult, menuElement: HTMLElement, activeElement: HTMLElement, disabledElement: HTMLElement
describe('test Menu and MenuItem component', () => {
    beforeEach(() => {
        wrapper = render(generateMenu(testProps))
        menuElement = wrapper.getByTestId('test-menu')
        activeElement = wrapper.getByText('active')
        disabledElement = wrapper.getByText('disabled')
    })
    it('should render correct Menu and MenuItem based default props', () => {
        expect(menuElement).toBeInTheDocument()
        expect(menuElement).toHaveClass('viking-menu test')
        expect(menuElement.getElementsByTagName('li').length).toEqual(3)
        expect(activeElement).toHaveClass('menu-item is-active')
        expect(disabledElement).toHaveClass('menu-item is-disabled')

    })
    it('click items should change active and call the right callback', () => {
        const thirdItem = wrapper.getByText('xyz')
        fireEvent.click(thirdItem)
        expect(thirdItem).toHaveClass('is-active')
        expect(activeElement).not.toHaveClass('is-active')
        expect(testProps.onSelect).toHaveBeenCalledWith(2)
        fireEvent.click(disabledElement)
        expect(disabledElement).not.toHaveClass('is-active')
        expect(testProps.onSelect).not.toHaveBeenCalledWith(1)
    })
    it('should render vertical mode when mode is set to vertical', () => {
        cleanup()
        const wrapper = render(generateMenu(testVerticalProps))
        const menuElement = wrapper.getByTestId('test-menu')
        expect(menuElement).toHaveClass('menu-vertical')
    })
})
```

#### 2021å¹´02æœˆ25æ—¥ å‘¨å››  09å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ—¥è¶‹å®Œç¾ - Menu ç»„ä»¶ç¼–ç ç¬¬ä¸‰éƒ¨åˆ†

```tsx
 const renderChildren = () => {
        return React.Children.map(children, (child, index) => {
            const childElement = child as React.FunctionComponentElement<MenuItemProps>
            const { displayName } = childElement.type
            if (displayName === "MenuItem") {
                return React.cloneElement(childElement, { index })
            } else {
                console.error('Warning: Menu has a child which is not a MenuItem component!')
            }
        })
    }
    return (
        <ul className={classes} style={style} data-testid="test-menu">
            <MenuContext.Provider value={passContext}>
                {renderChildren()}
            </MenuContext.Provider>
        </ul>
    )
```

#### 2021å¹´02æœˆ27æ—¥ å‘¨å…­  09å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šåŠŸèƒ½ç»§ç»­å‡çº§ - SubMenu ä¸‹æ‹‰èœå•ç¼–ç ç¬¬ä¸€éƒ¨åˆ†

```jsx
// æ›´åŠ è¯­ä¹‰åŒ– æ›´åŠ åƒ HTML çš„è§£å†³æ–¹æ¡ˆ
<Menu defaultIndex={0} onSelect={}>
  <Menu.Item index={"0"}>title one</Menu.Item>
  <Menu.Item disalbed  index={"1"}>disalbed link</Menu.Item>
  <Menu.SubMenu title={'test'}  index={"2"}> 
  	<Menu.Item index={"2-0"}>cool link</Menu.Item>
    <Menu.Item index={"2-1"}>cool link</Menu.Item>
  </Menu.SubMenu>
  <Menu.Item index={"3"}><a href="https://www.google.com">Google</a></Menu.Item>
</Menu>
```

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šæ·»åŠ äº¤äº’ - SubMenuä¸‹æ‹‰èœå•ç¼–ç ç¬¬äºŒéƒ¨åˆ†

```tsx
import React, { useContext, useState, FunctionComponentElement } from 'react'
import classNames from 'classnames'
import { MenuContext } from './menu'
import { MenuItemProps } from './menuItem'

export interface SubMenuProps {
    index?: number;
    title?: string;
    className?: string;
}

const SubMenu: React.FC<SubMenuProps> = ({ index, title, children, className }) => {
    const context = useContext(MenuContext)
    const [menuOpen, setOpen] = useState(false)
    const classes = classNames('menu-item submenu-item', className, {
        'is-active': context.index === index
    })
    const handleClick = (e: React.MouseEvent) => {
        e.preventDefault()
        setOpen(!menuOpen)
    }
    let timer: any
    const handleMouse = (e: React.MouseEvent, toggle: boolean) => {
        clearTimeout(timer)
        e.preventDefault()
        timer = setTimeout(() => {
            setOpen(toggle)
        }, 300)
    }
    const clickEvents = context.mode === 'vertical' ? { onClick: handleClick } : {}
    const hoverEvents = context.mode !== 'vertical' ? {
        onMouseEnter: (e: React.MouseEvent) => { handleMouse(e, true) },
        onMouseLeave: (e: React.MouseEvent) => { handleMouse(e, false) },
    } : {}
    const renderChildren = () => {
        const subMenuClasses = classNames('viking-submenu', {
            'menu-opened': menuOpen
        })
        const childrenComponent = React.Children.map(children, (child, i) => {
            const childElement = child as FunctionComponentElement<MenuItemProps>
            if (childElement.type.displayName === "MenuItem") {
                return childElement
            } else {
                console.error('Warning:SubMenu has a child which is not a MenuItem component')
            }
        })
        return (
            <ul className={subMenuClasses}>{childrenComponent}</ul>
        )
    }
    return (
        <li key={index} className={classes} {...hoverEvents}>
            <div className='submenu-title' onClick={handleClick} {...clickEvents}>{title}</div>
            {renderChildren()}
        </li>
    )
}
SubMenu.displayName = 'SubMenu'
export default SubMenu
```

#### 2021å¹´02æœˆ28æ—¥ å‘¨æ—¥  09å‘¨

(1)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šå¤§åŠŸå‘Šæˆ - SubMenu ä¸‹æ‹‰èœå•ç¼–ç ç¬¬ä¸‰éƒ¨åˆ†

æŠŠ index çš„ç±»å‹è¦å®šä¹‰æˆ string ç±»å‹;

(2)TS+React æ‰“é€ ç»„ä»¶åº“ï¼šå®Œç¾ç»„ä»¶ - SubMenu ç»„ä»¶æ·»åŠ æµ‹è¯•

```tsx
it('should show dropdown items when hover on subMenu', async () => {
        expect(wrapper.queryByText('drop1')).not.toBeVisible()
        const dropdownElement = wrapper.getByText('dropdown')
        fireEvent.mouseEnter(dropdownElement)
        await waitFor(() => {
            expect(wrapper.queryByText('drop1')).toBeVisible()
        })
        fireEvent.click(wrapper.getByText('drop1'))
        expect(testProps.onSelect).toHaveBeenCalledWith('3-0')
        fireEvent.mouseLeave(dropdownElement)
        await waitFor(() => {
            expect(wrapper.queryByText('drop1')).not.toBeVisible()
        })
    })
```













